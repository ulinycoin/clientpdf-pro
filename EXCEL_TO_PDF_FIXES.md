# Excel to PDF - Фиксы альбомной ориентации и заголовков столбцов

## Исправленные проблемы

### 1. Альбомная ориентация не работала
**Проблема**: PDF всегда создавался в портретной ориентации независимо от настроек.

**Решение**:
- Добавлена функция `getPageDimensions()` для правильного расчета размеров страницы
- Поддержка всех размеров страниц (A4, A3, Letter, Legal) в обеих ориентациях
- При создании новых страниц также используется правильная ориентация

```typescript
private getPageDimensions(pageSize: string, orientation: string): [number, number] {
  const pageSizes = {
    'A4': { width: 595, height: 842 },
    'A3': { width: 842, height: 1191 },
    'Letter': { width: 612, height: 792 },
    'Legal': { width: 612, height: 1008 }
  };

  const size = pageSizes[pageSize as keyof typeof pageSizes] || pageSizes.A4;

  if (orientation === 'landscape') {
    return [size.height, size.width]; // Меняем местами для альбомной
  }

  return [size.width, size.height];
}
```

### 2. Обозначения столбцов A, B, C, D...
**Проблема**: Заголовки таблицы отображались как буквы столбцов Excel (A, B, C, D...) вместо реального содержимого.

**Решение**:
- Теперь используется первая строка Excel файла как заголовки таблицы
- Если первая строка пустая, используется "Column 1", "Column 2" и т.д.
- Данные таблицы начинаются со второй строки
- Пустые строки автоматически фильтруются

```typescript
// Используем первую строку как заголовки
const firstRowCell = data[0]?.[originalCol];
if (firstRowCell && firstRowCell.value !== null && firstRowCell.value !== undefined && firstRowCell.value !== '') {
  headerText = String(firstRowCell.value);
} else {
  headerText = `Column ${newIndex + 1}`;
}

// Начинаем данные со второй строки
const startRow = data.length > 1 ? 1 : 0;
```

## Дополнительные улучшения

1. **Полные заголовки**: Заголовки больше не обрезаются до 8 символов
2. **Лучшая обработка шрифтов**: Корректная транслитерация для заголовков при необходимости
3. **Фильтрация пустых строк**: Строки без содержимого не попадают в PDF
4. **Юнит тесты**: Добавлены тесты для проверки новой функциональности

## Файлы изменены

- `src/services/excelToPDFGenerator.ts` - основные исправления
- `src/services/excelToPDFGenerator.test.ts` - новые тесты

## Тестирование

Все изменения покрыты юнит тестами, проверяющими:
- Правильность размеров страниц для разных ориентаций
- Использование первой строки как заголовков
- Обработку пустых строк и столбцов
- Транслитерацию текста

Изменения полностью обратно совместимы и не нарушают существующую функциональность.
