{
  "$schema": "https://context7.com/schema/context7.json",
  "projectTitle": "LocalPDF v3",
  "description": "Privacy-first PDF toolkit - Dual-application architecture with React 19 SPA (100% client-side PDF processing) and Astro SSG (SEO landing pages). Features 19 fully implemented tools: merge, split, compress, protect, OCR, watermark, add-text, edit-text, add-form-fields, rotate, delete-pages, extract-pages, extract-images, images-to-pdf, pdf-to-images, pdf-to-word, word-to-pdf, sign, flatten. Built with TypeScript, Vite, pdf-lib, pdfjs-dist, tesseract.js. Optimized bundle: 74 KB gzip initial load (91% reduction from 817 KB). Currently English-only interface. Hash-based routing with context tracking. Deployed on Vercel.",
  "folders": [
    "src/components/tools",
    "src/components/common",
    "src/components/ui",
    "src/components/layout",
    "src/hooks",
    "src/services",
    "src/utils",
    "src/types",
    "src/locales",
    "website/src/pages",
    "website/src/components",
    "website/src/layouts",
    "website/src/content"
  ],
  "excludeFolders": [
    "node_modules",
    "dist",
    "website/dist",
    "website/node_modules",
    ".vercel",
    ".git",
    "public",
    "website/public"
  ],
  "excludeFiles": [
    "*.log",
    "*.lock",
    "package-lock.json",
    "*.map",
    "*.d.ts"
  ],
  "rules": [
    "CRITICAL: Always use React.lazy() for tool components - NEVER import directly. Example: const MergePDF = lazy(() => import('@/components/tools/MergePDF').then(m => ({ default: m.MergePDF })))",
    "CRITICAL: All PDF libraries MUST be in vite.config.ts manualChunks: vendor-pdf-lib (pdf-lib, @pdf-lib/fontkit), vendor-pdfjs (pdfjs-dist), vendor-ocr (tesseract.js), vendor-word (mammoth, docx)",
    "CRITICAL: Initial bundle must stay under 100 KB gzip - currently 74 KB (target achieved). Run 'npm run build' to verify after changes",
    "Hash routing only: Use /#merge, /#split format via useHashRouter hook. NEVER use react-router or browser routing",
    "100% client-side: All PDF processing in-browser using Web Workers. NO server uploads, NO API calls, NO external dependencies",
    "PDFService singleton: Always use PDFService.getInstance() - never instantiate directly. All methods return PDFProcessingResult<T> with success/error states",
    "Progress callbacks: All PDFService methods accept onProgress?: (progress: number, message: string) => void parameter",
    "Path aliases: Use @ for src root (@/components, @/hooks, @/utils, @/types, @/services, @/locales, @/lib)",
    "Language: Currently English-only interface. Locale files exist for future multi-language support (src/locales/{en,ru,de,fr,es}.json), but useI18n() hook is available with nested keys (e.g., t('tools.merge-pdf.name'))",
    "Type safety: All components, hooks, services must have TypeScript types. Import types from @/types",
    "Dual architecture: website/ is Astro SSG for SEO pages (/merge-pdf), src/ is React SPA for tools (/#merge). SEO pages link to app hash routes",
    "Tool component pattern: Use FileUpload, ProgressBar, Button from common/ui. Handle processing state, progress, errors. Download result with downloadBlob()",
    "Styling: Use Tailwind CSS with custom ocean/privacy palette. Dark mode via dark: prefix. Custom utilities: .glass, .glass-dark, .text-gradient-ocean",
    "State management: No Redux/Zustand. Use React hooks + singleton patterns (useHashRouter, useI18n, useSharedFile)",
    "File sharing: Use useSharedFile() hook to share files between tools (e.g., split → merge)",
    "Adding new tools: MANDATORY steps: 1) Create tool component in src/components/tools/{ToolName}PDF.tsx, 2) Add lazy import in App.tsx with React.lazy(), 3) Add tool to render logic in App.tsx Suspense block, 4) Add to Sidebar.tsx navigation (with icon, name, tier), 5) Add translations to all 5 locale files (src/locales/{en,ru,de,fr,es}.json), 6) Create SEO landing page in website/src/pages/{tool-id}.astro using ToolPage component, 7) Update TOOL_HASH_MAP and HASH_TOOL_MAP in src/types/index.ts, 8) Verify bundle size with 'npm run build' (must stay under 100 KB gzip initial load)",
    "SEO pages (Astro): Every tool MUST have a corresponding SEO landing page in website/src/pages/{tool-id}.astro. Use ToolPage component with props: toolId, title, description, metaDescription, benefits[], steps[], faqs[]. Page automatically links to app hash route (/#tool). Example: /merge-pdf page → /#merge app tool",
    "Vercel deployment: build-vercel.mjs builds both apps and merges outputs. App-SPA → /app/, Website → / (root)",
    "shadcn/ui: All UI components in src/components/ui/ follow shadcn conventions. Use cn() from @/lib/utils for className merging",
    "Error handling: All PDFService methods return {success, data?, error?}. Display errors with toast.error() from sonner",
    "Performance: Use Web Workers for heavy operations (OCR, compression). Split operations into chunks with progress updates"
  ],
  "previousVersions": [
    {
      "tag": "v3.0.0",
      "description": "Complete rewrite with modern architecture, code splitting, and performance optimization"
    },
    {
      "tag": "v3.1.0",
      "description": "Migration to shadcn/ui, Buy Me a Coffee integration, major OCR improvements"
    }
  ]
}
