var q=Object.defineProperty;var K=(n,t,r)=>t in n?q(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r;var b=(n,t,r)=>(K(n,typeof t!="symbol"?t+"":t,r),r);import{r as p,j as e,h as X,F as V,P as Q,E as Z,i as G,k as J,l as ee,D as te,m as se,c as re}from"./react-vendor-7056d561.js";import{S as ae,t as oe}from"./SEOHead-62068eeb.js";import{a as ne,u as le,H as ie,F as ce}from"./index-d5079f2d.js";import{S as z,P as de,f as me,r as R}from"./pdf-lib-vendor-cbec66d4.js";import"./pdfjs-vendor-36642749.js";import{e as O,c as _}from"./word-vendor-1d2b0f77.js";import{f as ue}from"./utils-vendor-4b732c04.js";import{B as ge}from"./Breadcrumbs-eb59f8d6.js";import{R as he}from"./RelatedTools-29970fb3.js";import{F as fe}from"./FAQSection-00df29a0.js";import"./vendor-3f6e9ecd.js";import"./router-vendor-bd41c70c.js";const I=class I{static getInstance(){return this.instance||(this.instance=new I),this.instance}detectLanguage(t){if(!t||t.trim().length<10)return this.fallbackDetection(t);try{const r=ue(t),s=this.mapLanguageCode(r),a=this.isCyrillicLanguage(s);return{language:s,confidence:this.calculateConfidence(t,s),isCyrillic:a,recommendedFont:this.getRecommendedFont(s,a)}}catch(r){return console.warn("Language detection failed, using fallback:",r),this.fallbackDetection(t)}}fallbackDetection(t){const s=/[\u0400-\u04FF]/.test(t);return{language:s?"ru":"en",confidence:.5,isCyrillic:s,recommendedFont:this.getRecommendedFont(s?"ru":"en",s)}}mapLanguageCode(t){return{rus:"ru",ukr:"uk",bul:"bg",srp:"sr",eng:"en",fra:"fr",deu:"de",spa:"es",ita:"it",und:"en"}[t]||"en"}isCyrillicLanguage(t){return["ru","uk","bg","sr","mk","be"].includes(t)}calculateConfidence(t,r){const s=t.length;return s<50?.3:s<200?.6:s<500?.8:.9}getRecommendedFont(t,r){if(r)return"DejaVu Sans";switch(t){case"en":case"fr":case"de":case"es":case"it":return"Helvetica";default:return"Helvetica"}}detectMixedLanguages(t){const r=t.split(/\n+/).filter(a=>a.trim().length>20);if(r.length<=1)return[this.detectLanguage(t)];const s=[];for(const a of r.slice(0,5)){const o=this.detectLanguage(a);s.find(l=>l.language===o.language)||s.push(o)}return s.length>0?s:[this.detectLanguage(t)]}getPrimaryLanguage(t){return this.detectMixedLanguages(t).reduce((s,a)=>a.isCyrillic&&!s.isCyrillic||a.confidence>s.confidence?a:s)}};b(I,"instance");let L=I;class xe{constructor(){b(this,"languageDetector");this.languageDetector=L.getInstance()}validateFile(t){if(t.size>52428800)throw new Error("File is too large. Maximum file size is 50MB.");if(t.size===0)throw new Error("The uploaded file is empty.");if(!t.name.toLowerCase().endsWith(".docx"))throw new Error("Only .docx files are supported. Please convert .doc files to .docx format first.");t.type&&!t.type.includes("openxmlformats-officedocument.wordprocessingml")&&console.warn(`Unexpected MIME type: ${t.type}. Expected .docx format.`)}async parseDocument(t){try{this.validateFile(t);const r=await t.arrayBuffer();if(r.byteLength===0)throw new Error("The uploaded file is empty.");console.log("📁 File info:",{name:t.name,size:t.size,type:t.type,arrayBufferSize:r.byteLength});let s,a;try{s=await O({arrayBuffer:r}),a=await _({arrayBuffer:r})}catch(d){console.warn("Standard parsing failed, trying with alternative options:",d.message);try{s=await O({arrayBuffer:r,ignoreEmptyParagraphs:!1}),a=await _({arrayBuffer:r,ignoreEmptyParagraphs:!1})}catch{throw d.message.includes("body element")?new Error("This file does not appear to be a valid Word document. Please ensure you are uploading a .docx file created by Microsoft Word or a compatible application."):d}}s.messages&&s.messages.length>0&&console.warn("Mammoth text parsing warnings:",s.messages),a.messages&&a.messages.length>0&&console.warn("Mammoth HTML parsing warnings:",a.messages);const o=s.value||"",l=a.value||"";if(!o.trim())throw new Error("No text content found in the document. The file may be empty or corrupted.");console.log("📄 Extracted text preview:",{length:o.length,firstChars:o.substring(0,100),hasCyrillic:/[\u0400-\u04FF]/.test(o),hasHtml:l.length>o.length});const i=this.languageDetector.getPrimaryLanguage(o);console.log("🌍 Detected language:",i);const u=o.split(/\n+/).map(d=>d.trim()).filter(d=>d.length>0);if(u.length===0)throw new Error("No readable text found in the document.");const c=u.map(d=>({text:d,language:i.language,formatting:{fontFamily:i.recommendedFont,fontSize:12,bold:!1,italic:!1,underline:!1,color:"#000000"},alignment:"left"})),f={title:t.name.replace(/\.[^/.]+$/,""),pageCount:Math.ceil(c.length/20),language:i.language,isCyrillic:i.isCyrillic,detectedLanguages:this.languageDetector.detectMixedLanguages(o).map(d=>d.language)};return{paragraphs:c,metadata:f}}catch(r){console.error("Error parsing Word document:",r);const s=r.message||"Unknown error";throw s.includes("Could not find the body element")?new Error("This file does not appear to be a valid .docx document. Only modern Word format (.docx) is supported. If you have a .doc file, please save it as .docx first."):s.includes("Only .docx files are supported")?new Error(s):s.includes("signature")?new Error("Invalid Word document format. The file may be corrupted or not a genuine .docx document."):s.includes("No text content found")?new Error(s):s.includes("File is too large")?new Error(s):s.includes("Invalid file format")?new Error(s):s.includes("empty")?new Error("The uploaded file is empty or corrupted."):new Error(`Unable to process this Word document. Please ensure it's a valid .docx file. Error details: ${s}`)}}}const M=class M{constructor(){b(this,"cyrillicToLatin",{а:"a",б:"b",в:"v",г:"g",д:"d",е:"e",ё:"yo",ж:"zh",з:"z",и:"i",й:"y",к:"k",л:"l",м:"m",н:"n",о:"o",п:"p",р:"r",с:"s",т:"t",у:"u",ф:"f",х:"kh",ц:"ts",ч:"ch",ш:"sh",щ:"shch",ъ:"",ы:"y",ь:"",э:"e",ю:"yu",я:"ya",А:"A",Б:"B",В:"V",Г:"G",Д:"D",Е:"E",Ё:"Yo",Ж:"Zh",З:"Z",И:"I",Й:"Y",К:"K",Л:"L",М:"M",Н:"N",О:"O",П:"P",Р:"R",С:"S",Т:"T",У:"U",Ф:"F",Х:"Kh",Ц:"Ts",Ч:"Ch",Ш:"Sh",Щ:"Shch",Ъ:"",Ы:"Y",Ь:"",Э:"E",Ю:"Yu",Я:"Ya",і:"i",ї:"yi",є:"ye",ґ:"g",І:"I",Ї:"Yi",Є:"Ye",Ґ:"G","№":"No.","₽":"rub."})}static getInstance(){return this.instance||(this.instance=new M),this.instance}transliterate(t){return t&&t.split("").map(s=>{const a=this.cyrillicToLatin[s];return a===void 0&&/[\u0400-\u04FF]/.test(s)?(console.warn(`Cyrillic character not in transliteration map: "${s}" (${s.charCodeAt(0).toString(16)})`),"?"):a!==void 0?a:s}).join("").replace(/\s+/g," ").trim()}hasCyrillic(t){return/[\u0400-\u04FF]/.test(t)}getPreview(t){const r=t.substring(0,100),s=this.transliterate(r);return{original:r+(t.length>100?"...":""),transliterated:s+(t.length>100?"...":""),hasChanges:r!==s}}selectiveTransliterate(t,r){if(!t||r.length===0)return t;let s=t;return r.forEach(a=>{const o=this.cyrillicToLatin[a];o!==void 0&&(s=s.replace(new RegExp(a,"g"),o))}),s}getStatistics(t){const r=t.length,s=t.match(/[\u0400-\u04FF]/g)||[],a=s.length,o=[...new Set(s)],l=o.every(i=>this.cyrillicToLatin[i]!==void 0);return{totalChars:r,cyrillicChars:a,cyrillicPercentage:r>0?a/r*100:0,uniqueCyrillicChars:o,canTransliterate:l}}smartTransliterate(t,r=!0){if(!this.hasCyrillic(t))return t;let s=t;const a=[];if(r){const o=/(https?:\/\/[^\s]+)/g,l=/([a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,})/g;s=s.replace(o,i=>(a.push(i),`__PRESERVED_${a.length-1}__`)),s=s.replace(l,i=>(a.push(i),`__PRESERVED_${a.length-1}__`))}return s=this.transliterate(s),this.hasCyrillic(s)&&(console.warn("Cyrillic characters still present after smart transliteration, applying basic transliteration"),s=this.transliterate(s)),r&&a.length>0&&a.forEach((o,l)=>{s=s.replace(`__PRESERVED_${l}__`,o)}),s}};b(M,"instance");let $=M;const A=class A{constructor(){b(this,"fontCache",new Map);b(this,"transliterator");b(this,"availableFonts",{Helvetica:{name:"Helvetica",supports:["en","fr","de","es","it"],isStandard:!0},"Times-Roman":{name:"Times-Roman",supports:["en","fr","de","es","it"],isStandard:!0},Courier:{name:"Courier",supports:["en","fr","de","es","it"],isStandard:!0},"Cyrillic-Fallback":{name:"Helvetica",supports:["ru","uk","bg","sr"],fallback:"Helvetica",isStandard:!0}});this.transliterator=$.getInstance()}static getInstance(){return this.instance||(this.instance=new A),this.instance}async loadFont(t,r,s=!1){try{const a=this.selectBestFont(r,s),o=Math.random().toString(36).substr(2,9),l=`${a}-${r}-${o}`;let i,u=!1,c=s;if(s)try{i=await this.loadCyrillicFont(t,r),u=!0,c=!1,console.log(`✅ Cyrillic font loaded successfully for ${r}. No transliteration needed.`)}catch{console.warn("Failed to load Cyrillic font, falling back to standard font with transliteration"),i=await this.loadStandardFont(t,"Helvetica"),u=!1,c=!0}else i=await this.loadStandardFont(t,a),u=!1,c=!1;return this.fontCache.set(l,{font:i,supportsCyrillic:u,needsTransliteration:c}),this.cleanupOldCacheEntries(),{font:i,fontName:a,supportsCyrillic:u,needsTransliteration:c}}catch(a){return console.warn(`Failed to load font for ${r}, using fallback:`,a),{font:await t.embedFont(z.Helvetica),fontName:"Helvetica",supportsCyrillic:!1,needsTransliteration:s}}}async loadStandardFont(t,r){switch(r){case"Times-Roman":return await t.embedFont(z.TimesRoman);case"Courier":return await t.embedFont(z.Courier);case"Helvetica":default:return await t.embedFont(z.Helvetica)}}async loadCyrillicFont(t,r){try{const s="https://fonts.gstatic.com/s/notosans/v36/o-0mIpQlx3QUlC5A4PNB6Ryti20_6n1iPHjcz6L1SoM-jCpoiyD9A-9a6Vs.woff2";console.log(`Loading Noto Sans Cyrillic font for ${r}...`);const a=await fetch(s,{mode:"cors"});if(!a.ok)throw new Error(`Failed to fetch font: ${a.status} ${a.statusText}`);const o=await a.arrayBuffer(),l=await t.embedFont(o);return console.log(`✅ Successfully loaded Noto Sans Cyrillic for ${r}`),l}catch(s){console.warn(`Failed to load Noto Sans for ${r}, trying DejaVu Sans:`,s.message);try{const o=await fetch("https://cdn.jsdelivr.net/npm/dejavu-fonts-ttf@2.37.3/ttf/DejaVuSans.ttf",{mode:"cors"});if(!o.ok)throw new Error(`Fallback font failed: ${o.status} ${o.statusText}`);const l=await o.arrayBuffer(),i=await t.embedFont(l);return console.log(`✅ Successfully loaded DejaVu Sans for ${r}`),i}catch(a){console.warn("DejaVu Sans failed, trying PT Sans:",a.message);try{const l=await fetch("https://fonts.gstatic.com/s/ptsans/v17/jizaRExUiTo99u79D0KEwA.woff2",{mode:"cors"});if(!l.ok)throw new Error(`PT Sans failed: ${l.status} ${l.statusText}`);const i=await l.arrayBuffer(),u=await t.embedFont(i);return console.log(`✅ Successfully loaded PT Sans for ${r}`),u}catch(o){console.warn("All external fonts failed:",o.message);const l=!navigator.onLine||s.message.includes("Failed to fetch");throw l&&console.warn("🌐 App appears to be offline. Using Helvetica with transliteration."),new Error(`Unable to load Cyrillic fonts. ${l?"Check internet connection.":"Font service unavailable."}`)}}}}selectBestFont(t,r){return r?"Cyrillic-Fallback":"Helvetica"}getFontRecommendations(t,r){if(r)return["DejaVu Sans","Times New Roman","Arial Unicode MS","Helvetica"];switch(t){case"en":return["Helvetica","Times-Roman","Courier"];case"fr":case"de":case"es":case"it":return["Helvetica","Times-Roman"];default:return["Helvetica"]}}supportsLanguage(t,r){const s=this.availableFonts[t];return s?s.supports.includes(r):!1}getFallbackFont(t,r){return"Helvetica"}validateTextForFont(t,r){const s=/[\u0400-\u04FF]/g,a=t.match(s)||[],o=this.availableFonts[r],l=o&&o.supports.some(i=>["ru","uk","bg","sr"].includes(i));return a.length>0&&!l?{canRender:!1,unsupportedChars:a,recommendation:"Use Cyrillic-compatible font or transliterate text"}:{canRender:!0,unsupportedChars:[],recommendation:"Font is compatible"}}clearCache(){this.fontCache.clear()}cleanupOldCacheEntries(){if(this.fontCache.size>20){const r=Array.from(this.fontCache.entries()),s=r.slice(0,Math.floor(r.length/2));s.forEach(([a])=>{this.fontCache.delete(a)}),console.log(`🧹 Cleaned up ${s.length} old font cache entries`)}}};b(A,"instance");let H=A;class pe{constructor(){b(this,"fontManager");b(this,"languageDetector");b(this,"transliterator");this.fontManager=H.getInstance(),this.languageDetector=L.getInstance(),this.transliterator=$.getInstance()}async createPDF(t,r){try{const s=await de.create();s.registerFontkit(me);const a=this.getPageSize(r.pageSize);let o=s.addPage(a),{width:l,height:i}=o.getSize();const u=r.margins||{top:20,right:20,bottom:20,left:20},c={top:u.top*2.83,right:u.right*2.83,bottom:u.bottom*2.83,left:u.left*2.83},f=l-c.left-c.right,d=i-c.top-c.bottom,m=t.metadata?.language||"en",v=t.metadata?.isCyrillic||!1;console.log("📝 Document analysis:",{language:m,isCyrillic:v,detectedLanguages:t.metadata?.detectedLanguages,firstParagraph:t.paragraphs[0]?.text?.substring(0,50)});const j=await this.fontManager.loadFont(s,m,v),h=j.font,F=j.needsTransliteration,g=j.supportsCyrillic;console.log("🔤 Font loading result:",{fontName:j.fontName,supportsCyrillic:g,needsTransliteration:F}),v&&(g&&!F?console.log("✅ Using native Cyrillic font support - original text will be preserved."):F&&console.warn("⚠️ Cyrillic text will be transliterated to Latin characters for PDF compatibility."));const y=r.fontSize||12,N=y*1.2;let x=i-c.top;for(const P of t.paragraphs){if(!P.text.trim())continue;let E=P.text;if(F&&this.transliterator.hasCyrillic(P.text))E=this.transliterator.smartTransliterate(P.text),this.transliterator.hasCyrillic(E)&&(console.warn("Cyrillic characters still present after transliteration, applying fallback"),E=this.transliterator.transliterate(E)),console.log(`Transliterated: "${P.text.substring(0,50)}..." -> "${E.substring(0,50)}..."`);else if(g){console.log(`Using original Cyrillic text: "${P.text.substring(0,50)}..."`);const T=[...new Set(P.text.split(""))].slice(0,20);console.log("🔤 Characters in text:",T.join(" "),`(codes: ${T.map(S=>S.charCodeAt(0)).join(", ")})`)}const Y=E.split(" ");let w="";for(const T of Y){const S=w?`${w} ${T}`:T,B=this.sanitizeTextForPDF(S,g);try{if(h.widthOfTextAtSize(B,y)<=f)w=B;else{if(w){x-N<c.bottom&&(o=s.addPage(a),x=i-c.top);const k=this.sanitizeTextForPDF(w,g);o.drawText(k,{x:c.left,y:x,size:y,font:h,color:R(0,0,0)}),x-=N}w=this.sanitizeTextForPDF(T,g)}}catch(U){console.warn("Text encoding error:",U,"for text:",S);const k=this.emergencySanitizeText(S);try{h.widthOfTextAtSize(k,y)<=f?w=k:(w&&(x-N<c.bottom&&(o=s.addPage(a),x=i-c.top),o.drawText(this.sanitizeTextForPDF(w,g),{x:c.left,y:x,size:y,font:h,color:R(0,0,0)}),x-=N),w=this.emergencySanitizeText(T))}catch(W){console.error("Final encoding error, skipping problematic text:",W);continue}}}if(w){x-N<c.bottom&&(o=s.addPage(a),x=i-c.top);try{const T=this.sanitizeTextForPDF(w,g);o.drawText(T,{x:c.left,y:x,size:y,font:h,color:R(0,0,0)})}catch{console.error("Final encoding error, applying emergency sanitization");const S=this.emergencySanitizeText(w);o.drawText(S,{x:c.left,y:x,size:y,font:h,color:R(0,0,0)})}x-=N}x-=N*.5}const D={};r.compression&&(D.compress=!0,D.addDefaultPage=!1);const C=await s.save(D);return console.log("📄 PDF generated successfully:",{pageSize:r.pageSize,fontSize:y,margins:u,compression:r.compression,finalSize:`${Math.round(C.length/1024)} KB`,pageCount:s.getPageCount()}),C}catch(s){throw console.error("Error generating PDF:",s),new Error(`Failed to generate PDF: ${s.message}`)}}getPageSize(t){switch(t){case"A4":return[595,842];case"Letter":return[612,792];case"A3":return[842,1191];default:return[595,842]}}sanitizeTextForPDF(t,r=!1){if(!t)return"";let s=t;const a={"≠":"!=","±":"+/-","×":"x","÷":"/","≤":"<=","≥":">=","≈":"~=","∞":"infinity","√":"sqrt","∑":"sum","∏":"prod",Δ:"delta","∂":"d","∫":"integral","“":'"',"”":'"',"‘":"'","’":"'","…":"...","–":"-","—":"--","§":"section","¶":"para","†":"+","‡":"++","£":"GBP","¥":"JPY","₽":"RUB","₴":"UAH","😀":":)","😁":":D","😂":":D","😍":"<3","😎":"B)","😘":":*","😜":";P","😢":":(","😭":"T_T","😱":":O","🙏":"+","👍":"+1","👎":"-1","💪":"*flex*","❤️":"<3","💖":"<3","🔥":"*fire*","⭐":"*","🎉":"*party*","←":"<-","↑":"^","→":"->","↓":"v","↔":"<->","⇐":"<=","⇒":"=>","✓":"v","✔":"V","✗":"x","✘":"X","✅":"[v]","❌":"[X]","❎":"[X]","°":"deg","™":"(TM)","®":"(R)","©":"(C)","¼":"1/4","½":"1/2","¾":"3/4",α:"alpha",β:"beta",γ:"gamma",δ:"delta",π:"pi",σ:"sigma",ω:"omega"};for(const[l,i]of Object.entries(a))s=s.replace(new RegExp(be(l),"g"),i);!r&&this.transliterator.hasCyrillic(s)&&(s=this.transliterator.smartTransliterate(s));const o=r?/[^\u0000-\u007F\u0080-\u00FF\u0100-\u017F\u0400-\u04FF\u2000-\u206F]/g:/[^\u0000-\u007F\u0080-\u00FF\u0100-\u017F]/g;return s=s.replace(o,"?"),s}emergencySanitizeText(t){if(!t)return"";let r=this.sanitizeTextForPDF(t,!1);return this.transliterator.hasCyrillic(r)&&(r=this.transliterator.transliterate(r)),r=r.replace(/[^\u0020-\u007E]/g,"?"),r=r.replace(/\?+/g,"?"),r=r.replace(/\s\?\s/g," "),r=r.replace(/^\?+|\?+$/g,""),r.trim()}}function be(n){return n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}class we{constructor(){b(this,"wordParser");b(this,"pdfGenerator");this.wordParser=new xe,this.pdfGenerator=new pe}async convertWordToPDF(t,r={pageSize:"A4",embedFonts:!0,margins:{top:20,right:20,bottom:20,left:20},fontSize:12,compression:!1}){try{if(!this.isValidWordFile(t))return{success:!1,error:"Please select a valid Word document (.docx, .doc)"};const s=await this.wordParser.parseDocument(t);return{success:!0,pdfBytes:await this.pdfGenerator.createPDF(s,r),metadata:s.metadata}}catch(s){return console.error("Conversion error:",s),{success:!1,error:s.message||"Conversion failed"}}}isValidWordFile(t){const r=[".doc",".docx"],s=t.name.toLowerCase();return r.some(a=>s.endsWith(a))}async downloadPDF(t,r){const s=new Blob([t],{type:"application/pdf"}),a=URL.createObjectURL(s),o=document.createElement("a");o.href=a,o.download=r.replace(/\.[^/.]+$/,"")+".pdf",document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(a)}}const ye=()=>{const[n,t]=p.useState(!1),[r,s]=p.useState(null),[a,o]=p.useState(!1),[l]=p.useState(()=>new we),i=async(m,v,j=!0)=>{t(!0),s(null);try{const h=await l.convertWordToPDF(m,v);s(h),h.success&&h.pdfBytes&&j&&await l.downloadPDF(h.pdfBytes,m.name)}catch(h){s({success:!1,error:h.message||"Conversion failed"})}finally{t(!1)}};return{isConverting:n,result:r,previewMode:a,convertFile:i,downloadPDF:async m=>{r?.success&&r.pdfBytes&&await l.downloadPDF(r.pdfBytes,m)},regenerateWithSettings:async(m,v)=>{await i(m,v,!1)},togglePreviewMode:()=>{o(!a)},reset:()=>{s(null),t(!1),o(!1)}}},ve=({settings:n,onSettingsChange:t,isVisible:r,onToggle:s})=>{const a=(o,l)=>{t({...n,[o]:l})};return e.jsxs("div",{className:"mb-6",children:[e.jsxs("button",{onClick:s,className:"flex items-center gap-2 w-full p-3 text-left text-gray-700 hover:bg-gray-50 rounded-lg border border-gray-200 transition-colors",children:[e.jsx(X,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:"Conversion Settings"}),e.jsx("span",{className:"ml-auto text-sm text-gray-500",children:r?"Hide":"Show"})]}),r&&e.jsxs("div",{className:"mt-3 p-4 bg-gray-50 rounded-lg border border-gray-200 space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700",children:[e.jsx(V,{className:"w-4 h-4"}),"Page Size"]}),e.jsxs("select",{value:n.pageSize,onChange:o=>a("pageSize",o.target.value),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"A4",children:"A4 (210 × 297 mm)"}),e.jsx("option",{value:"Letter",children:"Letter (8.5 × 11 in)"}),e.jsx("option",{value:"A3",children:"A3 (297 × 420 mm)"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Margins (mm)"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-600",children:"Top"}),e.jsx("input",{type:"number",min:"0",max:"50",value:n.margins?.top||20,onChange:o=>a("margins",{...n.margins,top:parseInt(o.target.value)||20}),className:"w-full p-2 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-600",children:"Bottom"}),e.jsx("input",{type:"number",min:"0",max:"50",value:n.margins?.bottom||20,onChange:o=>a("margins",{...n.margins,bottom:parseInt(o.target.value)||20}),className:"w-full p-2 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-600",children:"Left"}),e.jsx("input",{type:"number",min:"0",max:"50",value:n.margins?.left||20,onChange:o=>a("margins",{...n.margins,left:parseInt(o.target.value)||20}),className:"w-full p-2 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-600",children:"Right"}),e.jsx("input",{type:"number",min:"0",max:"50",value:n.margins?.right||20,onChange:o=>a("margins",{...n.margins,right:parseInt(o.target.value)||20}),className:"w-full p-2 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700",children:[e.jsx(Q,{className:"w-4 h-4"}),"Font Size"]}),e.jsxs("select",{value:n.fontSize||12,onChange:o=>a("fontSize",parseInt(o.target.value)),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:10,children:"10pt (Small)"}),e.jsx("option",{value:11,children:"11pt"}),e.jsx("option",{value:12,children:"12pt (Normal)"}),e.jsx("option",{value:14,children:"14pt (Large)"}),e.jsx("option",{value:16,children:"16pt (Extra Large)"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700",children:"Advanced Options"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",id:"embedFonts",checked:n.embedFonts,onChange:o=>a("embedFonts",o.target.checked),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),e.jsx("label",{htmlFor:"embedFonts",className:"text-sm text-gray-700",children:"Embed fonts for better compatibility"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",id:"compression",checked:n.compression||!1,onChange:o=>a("compression",o.target.checked),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),e.jsx("label",{htmlFor:"compression",className:"text-sm text-gray-700",children:"Compress PDF (smaller file size)"})]})]}),e.jsx("div",{className:"pt-3 border-t border-gray-200",children:e.jsx("button",{onClick:()=>t({pageSize:"A4",embedFonts:!0,margins:{top:20,right:20,bottom:20,left:20},fontSize:12,compression:!1}),className:"text-sm text-blue-600 hover:text-blue-800 transition-colors",children:"Reset to defaults"})})]})]})},je=({pdfBytes:n,fileName:t,onDownload:r,isGenerating:s,onRegenerate:a})=>{const[o,l]=p.useState(null),[i,u]=p.useState(!1),[c,f]=p.useState(null),[d,m]=p.useState(1);p.useEffect(()=>(n?v():j(),j),[n]);const v=async()=>{if(n){u(!0),f(null);try{const g=new Blob([n],{type:"application/pdf"}),y=URL.createObjectURL(g);l(y)}catch(g){console.error("Error generating preview:",g),f("Failed to generate preview")}finally{u(!1)}}},j=()=>{o&&(URL.revokeObjectURL(o),l(null))},h=()=>{m(g=>Math.min(g+.25,2))},F=()=>{m(g=>Math.max(g-.25,.5))};return s?e.jsx("div",{className:"border border-gray-200 rounded-lg p-6 bg-gray-50",children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-600",children:"Generating PDF preview..."})]})})}):n?c?e.jsx("div",{className:"border border-red-200 rounded-lg p-6 bg-red-50",children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center text-red-600",children:[e.jsx(G,{className:"w-12 h-12 mx-auto mb-3"}),e.jsx("p",{className:"font-medium",children:"Preview Error"}),e.jsx("p",{className:"text-sm",children:c}),a&&e.jsx("button",{onClick:a,className:"mt-3 text-sm text-red-600 hover:text-red-800 underline",children:"Try again"})]})})}):e.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden bg-white",children:[e.jsx("div",{className:"bg-gray-50 px-4 py-3 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(V,{className:"w-5 h-5 text-gray-500"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900",children:t}),e.jsx("p",{className:"text-sm text-gray-500",children:"PDF Preview"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1 bg-white border border-gray-300 rounded",children:[e.jsx("button",{onClick:F,disabled:d<=.5,className:"p-1 hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",title:"Zoom out",children:e.jsx(J,{className:"w-4 h-4"})}),e.jsxs("span",{className:"px-2 text-sm font-mono",children:[Math.round(d*100),"%"]}),e.jsx("button",{onClick:h,disabled:d>=2,className:"p-1 hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",title:"Zoom in",children:e.jsx(ee,{className:"w-4 h-4"})})]}),e.jsxs("button",{onClick:r,className:"flex items-center gap-2 px-3 py-1.5 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors",children:[e.jsx(te,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Download"})]})]})]})}),e.jsx("div",{className:"p-4",children:i?e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-500 mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Loading preview..."})]})}):o?e.jsx("div",{className:"relative overflow-auto max-h-96",children:e.jsx("iframe",{src:`${o}#toolbar=0&navpanes=0&scrollbar=0`,className:"w-full border border-gray-300 rounded",style:{height:"400px",transform:`scale(${d})`,transformOrigin:"top left",width:`${100/d}%`},title:"PDF Preview"})}):e.jsx("div",{className:"flex items-center justify-center h-96 text-gray-500",children:e.jsxs("div",{className:"text-center",children:[e.jsx(se,{className:"w-8 h-8 mx-auto mb-2"}),e.jsx("p",{children:"Preparing preview..."})]})})}),e.jsx("div",{className:"bg-gray-50 px-4 py-2 border-t border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-600",children:[e.jsx("span",{children:"Preview may differ slightly from final PDF"}),e.jsx("span",{children:n?`${Math.round(n.length/1024)} KB`:""})]})})]}):e.jsx("div",{className:"border border-gray-200 rounded-lg p-6 bg-gray-50",children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center text-gray-500",children:[e.jsx(Z,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"PDF preview will appear here"}),e.jsx("p",{className:"text-sm",children:"Upload a Word document to get started"})]})})})},Ne=()=>{const{t:n}=ne(),[t,r]=p.useState(null),[s,a]=p.useState(!0),[o,l]=p.useState(!1),[i,u]=p.useState({pageSize:"A4",embedFonts:!0,margins:{top:20,right:20,bottom:20,left:20},fontSize:12,compression:!1}),c=p.useRef(null),f=ye(),d=f.isConverting,m=f.result,v=f.convertFile,j=f.downloadPDF,h=f.regenerateWithSettings,F=f.reset,g=C=>{const P=C.target.files?.[0];P&&(r(P),l(!1),F())},y=()=>{F(),r(null),l(!1),c.current?.click()},N=async()=>{t&&(await v(t,i,!1),l(!0))},x=async()=>{t&&await j(t.name)},D=async C=>{u(C),t&&m?.success&&await h(t,C)};return e.jsx("div",{className:"max-w-7xl mx-auto p-6",children:t?e.jsxs("div",{className:"space-y-6",children:[m?.success&&e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(re,{className:"w-5 h-5 text-green-500 mr-2"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-green-800 font-medium",children:n("pages.tools.wordToPdf.tool.messages.conversionCompleted")}),e.jsxs("p",{className:"text-green-700 text-sm",children:["PDF is ready for download (",m.pdfBytes?Math.round(m.pdfBytes.length/1024):"0"," KB)"]})]})]})}),m&&!m.success&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(G,{className:"w-5 h-5 text-red-500 mr-2"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-red-800 font-medium",children:n("pages.tools.wordToPdf.tool.messages.conversionFailed")}),e.jsx("p",{className:"text-red-700 text-sm",children:m.error})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg overflow-hidden h-[600px]",children:[" ",o?e.jsx(je,{pdfBytes:m?.success&&m.pdfBytes||null,fileName:t?.name||"document.pdf",onDownload:x,isGenerating:d,onRegenerate:t?()=>N():void 0}):e.jsxs("div",{className:"p-8 text-center text-gray-500 flex flex-col items-center justify-center h-full",children:[e.jsx(Z,{className:"w-16 h-16 mx-auto mb-4 opacity-50"}),e.jsx("h3",{className:"text-xl font-medium mb-2",children:n("pages.tools.wordToPdf.tool.preview.title")}),e.jsx("p",{className:"text-sm mb-4",children:n("pages.tools.wordToPdf.tool.preview.description")}),t&&!m&&e.jsx("button",{onClick:N,disabled:d,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:n(d?"pages.tools.wordToPdf.tool.buttons.converting":"pages.tools.wordToPdf.tool.buttons.convertToPdf")})]})]})}),e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 h-[600px] flex flex-col",children:[" ",e.jsx("h2",{className:"text-xl font-semibold mb-4",children:n("pages.tools.wordToPdf.tool.settings.title")}),e.jsxs("div",{className:"flex-1 overflow-y-auto",children:[" ",e.jsx(ve,{settings:i,onSettingsChange:D,isVisible:s,onToggle:()=>a(!s)})]}),e.jsx("div",{className:"mt-6 pt-6 border-t flex-shrink-0",children:e.jsx("button",{onClick:N,disabled:!t||d,className:`w-full py-3 px-4 font-medium rounded-lg transition-colors ${!t||d?"bg-gray-400 cursor-not-allowed text-white":"bg-green-600 hover:bg-green-700 text-white"}`,children:d?e.jsxs("span",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"}),n("pages.tools.wordToPdf.tool.buttons.converting")]}):n("pages.tools.wordToPdf.tool.buttons.convertToPdf")})})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:n("pages.tools.wordToPdf.tool.fileInfo.title")}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsxs("strong",{children:[n("pages.tools.wordToPdf.tool.fileInfo.fileName"),":"]})," ",t.name]}),e.jsxs("div",{children:[e.jsxs("strong",{children:[n("pages.tools.wordToPdf.tool.fileInfo.fileSize"),":"]})," ",Math.round(t.size/1024)," KB"]}),e.jsxs("div",{children:[e.jsxs("strong",{children:[n("pages.tools.wordToPdf.tool.fileInfo.fileType"),":"]})," ",n("pages.tools.wordToPdf.tool.fileInfo.microsoftWord")]})]}),e.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[e.jsx("div",{className:"text-sm text-gray-600",children:n("pages.tools.wordToPdf.tool.fileInfo.privacyNote")}),e.jsx("button",{onClick:()=>{r(null),l(!1),F()},className:"text-sm text-red-600 hover:text-red-800 underline",disabled:d,children:n("pages.tools.wordToPdf.tool.buttons.chooseDifferent")})]})]})]}):e.jsx("div",{className:"max-w-2xl mx-auto",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8 mb-6",children:[e.jsx("input",{ref:c,type:"file",accept:".docx,application/vnd.openxmlformats-officedocument.wordprocessingml.document",onChange:g,className:"hidden"}),e.jsxs("div",{onClick:y,className:"text-center cursor-pointer p-6 border-2 border-dashed border-gray-300 rounded-lg hover:border-blue-400 hover:bg-blue-50 transition-colors",children:[e.jsx("div",{className:"text-6xl mb-4",children:"📝"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-2",children:n("pages.tools.wordToPdf.tool.uploadTitle")}),e.jsx("p",{className:"text-gray-500 mb-6",children:n("pages.tools.wordToPdf.tool.uploadSubtitle")}),e.jsx("div",{className:"mt-6 text-sm text-gray-400",children:e.jsx("p",{children:n("pages.tools.wordToPdf.tool.supportedFormats")})}),e.jsxs("div",{className:"mt-4 text-xs text-gray-400 space-y-1",children:[e.jsx("p",{children:n("pages.tools.wordToPdf.tool.compatibility.msWord")}),e.jsx("p",{children:n("pages.tools.wordToPdf.tool.compatibility.googleDocs")}),e.jsx("p",{children:n("pages.tools.wordToPdf.tool.compatibility.docWarning")}),e.jsx("p",{children:n("pages.tools.wordToPdf.tool.compatibility.localProcessing")})]})]})]})})})},Me=()=>{const{t:n}=le(),t=oe.wordToPdf,r=n("pages.tools.wordToPdf.faq.items");p.useEffect(()=>{window.scrollTo(0,0)},[]);const s=[{label:n("pages.tools.wordToPdf.breadcrumbs.home"),href:"/"},{label:n("pages.tools.wordToPdf.breadcrumbs.wordToPdf"),href:"/word-to-pdf"}];return e.jsxs(e.Fragment,{children:[e.jsx(ae,{title:t.title,description:t.description,keywords:t.keywords,canonical:t.canonical,structuredData:t.structuredData}),e.jsxs("div",{className:"min-h-screen bg-gradient-mesh flex flex-col",children:[e.jsx(ie,{}),e.jsxs("main",{className:"flex-grow container mx-auto px-4 pt-20 pb-8",children:[e.jsx(ge,{items:s}),e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-4",children:n("pages.tools.wordToPdf.pageTitle")}),e.jsx("p",{className:"text-lg text-gray-600 max-w-2xl mx-auto",children:n("pages.tools.wordToPdf.pageDescription")})]}),e.jsx(Ne,{}),e.jsx("div",{className:"mt-12 max-w-4xl mx-auto",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:n("pages.tools.wordToPdf.howTo.title")}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-6 mb-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center mx-auto mb-4",children:e.jsx("span",{className:"text-blue-600 font-bold text-xl",children:"1"})}),e.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:n("pages.tools.wordToPdf.howTo.steps.choose.title")}),e.jsx("p",{className:"text-gray-600 text-sm",children:n("pages.tools.wordToPdf.howTo.steps.choose.description")})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center mx-auto mb-4",children:e.jsx("span",{className:"text-blue-600 font-bold text-xl",children:"2"})}),e.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:n("pages.tools.wordToPdf.howTo.steps.convert.title")}),e.jsx("p",{className:"text-gray-600 text-sm",children:n("pages.tools.wordToPdf.howTo.steps.convert.description")})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center mx-auto mb-4",children:e.jsx("span",{className:"text-blue-600 font-bold text-xl",children:"3"})}),e.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:n("pages.tools.wordToPdf.howTo.steps.download.title")}),e.jsx("p",{className:"text-gray-600 text-sm",children:n("pages.tools.wordToPdf.howTo.steps.download.description")})]})]}),e.jsxs("div",{className:"border-t pt-8",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:n("pages.tools.wordToPdf.features.title")}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:n("pages.tools.wordToPdf.features.privacy.title")}),e.jsx("p",{className:"text-gray-600 text-sm",children:n("pages.tools.wordToPdf.features.privacy.description")})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:n("pages.tools.wordToPdf.features.fast.title")}),e.jsx("p",{className:"text-gray-600 text-sm",children:n("pages.tools.wordToPdf.features.fast.description")})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:n("pages.tools.wordToPdf.features.compatible.title")}),e.jsx("p",{className:"text-gray-600 text-sm",children:n("pages.tools.wordToPdf.features.compatible.description")})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:n("pages.tools.wordToPdf.features.quality.title")}),e.jsx("p",{className:"text-gray-600 text-sm",children:n("pages.tools.wordToPdf.features.quality.description")})]})]})]})]})}),e.jsx(fe,{title:n("pages.tools.wordToPdf.tool.faqTitle"),faqs:r,className:"mb-8",defaultOpen:!1}),e.jsx(he,{currentTool:"word-to-pdf"})]}),e.jsx(ce,{})]})]})};export{Me as default};
