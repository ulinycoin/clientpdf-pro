import{w as Ut,x as $,y as Vt,z as Zt,B as zt,C as Kt,D as Gt,E as Yt,F as zr}from"./vendor-3f6e9ecd.js";import{b as Kr}from"./pdfjs-vendor-36642749.js";var ur={},_={},Jt=$,V=Ut();_.defer=Qt;_.when=V.resolve;_.resolve=V.resolve;_.all=V.all;_.props=V.props;_.reject=V.reject;_.promisify=V.promisify;_.mapSeries=V.mapSeries;_.attempt=V.attempt;_.nfcall=function(e){var r=Array.prototype.slice.call(arguments,1),t=V.promisify(e);return t.apply(null,r)};V.prototype.fail=V.prototype.caught;V.prototype.also=function(e){return this.then(function(r){var t=Jt.extend({},r,e(r));return V.props(t)})};function Qt(){var e,r,t=new V.Promise(function(a,i){e=a,r=i});return{resolve:e,reject:r,promise:t}}var E={},en=$,F=E.types={document:"document",paragraph:"paragraph",run:"run",text:"text",tab:"tab",checkbox:"checkbox",hyperlink:"hyperlink",noteReference:"noteReference",image:"image",note:"note",commentReference:"commentReference",comment:"comment",table:"table",tableRow:"tableRow",tableCell:"tableCell",break:"break",bookmarkStart:"bookmarkStart"};function rn(e,r){return r=r||{},{type:F.document,children:e,notes:r.notes||new He({}),comments:r.comments||[]}}function tn(e,r){r=r||{};var t=r.indent||{};return{type:F.paragraph,children:e,styleId:r.styleId||null,styleName:r.styleName||null,numbering:r.numbering||null,alignment:r.alignment||null,indent:{start:t.start||null,end:t.end||null,firstLine:t.firstLine||null,hanging:t.hanging||null}}}function nn(e,r){return r=r||{},{type:F.run,children:e,styleId:r.styleId||null,styleName:r.styleName||null,isBold:!!r.isBold,isUnderline:!!r.isUnderline,isItalic:!!r.isItalic,isStrikethrough:!!r.isStrikethrough,isAllCaps:!!r.isAllCaps,isSmallCaps:!!r.isSmallCaps,verticalAlignment:r.verticalAlignment||Gr.baseline,font:r.font||null,fontSize:r.fontSize||null,highlight:r.highlight||null}}var Gr={baseline:"baseline",superscript:"superscript",subscript:"subscript"};function an(e){return{type:F.text,value:e}}function un(){return{type:F.tab}}function ln(e){return{type:F.checkbox,checked:e.checked}}function sn(e,r){return{type:F.hyperlink,children:e,href:r.href,anchor:r.anchor,targetFrame:r.targetFrame}}function on(e){return{type:F.noteReference,noteType:e.noteType,noteId:e.noteId}}function He(e){this._notes=en.indexBy(e,function(r){return Yr(r.noteType,r.noteId)})}He.prototype.resolve=function(e){return this.findNoteByKey(Yr(e.noteType,e.noteId))};He.prototype.findNoteByKey=function(e){return this._notes[e]||null};function cn(e){return{type:F.note,noteType:e.noteType,noteId:e.noteId,body:e.body}}function fn(e){return{type:F.commentReference,commentId:e.commentId}}function mn(e){return{type:F.comment,commentId:e.commentId,body:e.body,authorName:e.authorName,authorInitials:e.authorInitials}}function Yr(e,r){return e+"-"+r}function pn(e){return{type:F.image,read:function(r){return r?e.readImage(r):e.readImage().then(function(t){return Buffer.from(t)})},readAsArrayBuffer:function(){return e.readImage()},readAsBase64String:function(){return e.readImage("base64")},readAsBuffer:function(){return e.readImage().then(function(r){return Buffer.from(r)})},altText:e.altText,contentType:e.contentType}}function dn(e,r){return r=r||{},{type:F.table,children:e,styleId:r.styleId||null,styleName:r.styleName||null}}function hn(e,r){return r=r||{},{type:F.tableRow,children:e,isHeader:r.isHeader||!1}}function vn(e,r){return r=r||{},{type:F.tableCell,children:e,colSpan:r.colSpan==null?1:r.colSpan,rowSpan:r.rowSpan==null?1:r.rowSpan}}function lr(e){return{type:F.break,breakType:e}}function yn(e){return{type:F.bookmarkStart,name:e.name}}E.document=E.Document=rn;E.paragraph=E.Paragraph=tn;E.run=E.Run=nn;E.text=E.Text=an;E.tab=E.Tab=un;E.checkbox=E.Checkbox=ln;E.Hyperlink=sn;E.noteReference=E.NoteReference=on;E.Notes=He;E.Note=cn;E.commentReference=fn;E.comment=mn;E.Image=pn;E.Table=dn;E.TableRow=hn;E.TableCell=vn;E.lineBreak=lr("line");E.pageBreak=lr("page");E.columnBreak=lr("column");E.BookmarkStart=yn;E.verticalAlignment=Gr;var Z={},Ee=$;Z.Result=J;Z.success=gn;Z.warning=wn;Z.error=bn;function J(e,r){this.value=e,this.messages=r||[]}J.prototype.map=function(e){return new J(e(this.value),this.messages)};J.prototype.flatMap=function(e){var r=e(this.value);return new J(r.value,sr([this,r]))};J.prototype.flatMapThen=function(e){var r=this;return e(this.value).then(function(t){return new J(t.value,sr([r,t]))})};J.combine=function(e){var r=Ee.flatten(Ee.pluck(e,"value")),t=sr(e);return new J(r,t)};function gn(e){return new J(e,[])}function wn(e){return{type:"warning",message:e}}function bn(e){return{type:"error",message:e.message,error:e}}function sr(e){var r=[];return Ee.flatten(Ee.pluck(e,"messages"),!0).forEach(function(t){Tn(r,t)||r.push(t)}),r}function Tn(e,r){return Ee.find(e,En.bind(null,r))!==void 0}function En(e,r){return e.type===r.type&&e.message===r.message}var Re={},kn=Zt,xn=Vt;Re.openArrayBuffer=Rn;Re.splitPath=Sn;Re.joinPath=In;function Rn(e){return xn.loadAsync(e).then(function(r){function t(s){return r.file(s)!==null}function a(s,c){return r.file(s).async("uint8array").then(function(f){if(c==="base64")return kn.fromByteArray(f);if(c){var d=new TextDecoder(c);return d.decode(f)}else return f})}function i(s,c){r.file(s,c)}function o(){return r.generateAsync({type:"arraybuffer"})}return{exists:t,read:a,write:i,toArrayBuffer:o}})}function Sn(e){var r=e.lastIndexOf("/");return r===-1?{dirname:"",basename:e}:{dirname:e.substring(0,r),basename:e.substring(r+1)}}function In(){var e=Array.prototype.filter.call(arguments,function(t){return t}),r=[];return e.forEach(function(t){/^\//.test(t)?r=[t]:r.push(t)}),r.join("/")}var or={},te={},he={},Ae=$;he.Element=ve;he.element=function(e,r,t){return new ve(e,r,t)};he.text=function(e){return{type:"text",value:e}};var Jr=he.emptyElement={first:function(){return null},firstOrEmpty:function(){return Jr},attributes:{},children:[]};function ve(e,r,t){this.type="element",this.name=e,this.attributes=r||{},this.children=t||[]}ve.prototype.first=function(e){return Ae.find(this.children,function(r){return r.name===e})};ve.prototype.firstOrEmpty=function(e){return this.first(e)||Jr};ve.prototype.getElementsByTagName=function(e){var r=Ae.filter(this.children,function(t){return t.name===e});return Qr(r)};ve.prototype.text=function(){if(this.children.length===0)return"";if(this.children.length!==1||this.children[0].type!=="text")throw new Error("Not implemented");return this.children[0].value};var On={getElementsByTagName:function(e){return Qr(Ae.flatten(this.map(function(r){return r.getElementsByTagName(e)},!0)))}};function Qr(e){return Ae.extend(e,On)}var et={},cr={},Pn=Kt,Nn=zt;function Cn(e){var r=null,t=new Pn.DOMParser({errorHandler:function(i,o){r={level:i,message:o}}}),a=t.parseFromString(e);if(r===null)return a;throw new Error(r.level+": "+r.message)}cr.parseFromString=Cn;cr.Node=Nn.Node;var er=_,kr=$,rt=cr,tt=he,Bn=tt.Element;et.readString=$n;var xr=rt.Node;function $n(e,r){r=r||{};try{var t=rt.parseFromString(e,"text/xml")}catch(s){return er.reject(s)}if(t.documentElement.tagName==="parsererror")return er.resolve(new Error(t.documentElement.textContent));function a(s){switch(s.nodeType){case xr.ELEMENT_NODE:return i(s);case xr.TEXT_NODE:return tt.text(s.nodeValue)}}function i(s){var c=o(s),f=[];kr.forEach(s.childNodes,function(p){var T=a(p);T&&f.push(T)});var d={};return kr.forEach(s.attributes,function(p){d[o(p)]=p.value}),new Bn(c,d,f)}function o(s){if(s.namespaceURI){var c=r[s.namespaceURI],f;return c?f=c+":":f="{"+s.namespaceURI+"}",f+s.localName}else return s.localName}return er.resolve(a(t.documentElement))}var nt={},Rr=$,_n=Gt;nt.writeString=Mn;function Mn(e,r){var t=Rr.invert(r),a={element:o,text:Fn};function i(f,d){return a[d.type](f,d)}function o(f,d){var p=f.element(s(d.name),d.attributes);d.children.forEach(function(T){i(p,T)})}function s(f){var d=/^\{(.*)\}(.*)$/.exec(f);if(d){var p=t[d[1]];return p+(p===""?"":":")+d[2]}else return f}function c(f){var d=_n.create(s(f.name),{version:"1.0",encoding:"UTF-8",standalone:!0});return Rr.forEach(r,function(p,T){var N="xmlns"+(T===""?"":":"+T);d.attribute(N,p)}),f.children.forEach(function(p){i(d,p)}),d.end()}return c(e)}function Fn(e,r){e.text(r.value)}var De=he;te.Element=De.Element;te.element=De.element;te.emptyElement=De.emptyElement;te.text=De.text;te.readString=et.readString;te.writeString=nt.writeString;var qn=$,Hn=_,An=te;or.read=at;or.readXmlFromZipFile=Wn;var Dn={"http://schemas.openxmlformats.org/wordprocessingml/2006/main":"w","http://schemas.openxmlformats.org/officeDocument/2006/relationships":"r","http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing":"wp","http://schemas.openxmlformats.org/drawingml/2006/main":"a","http://schemas.openxmlformats.org/drawingml/2006/picture":"pic","http://purl.oclc.org/ooxml/wordprocessingml/main":"w","http://purl.oclc.org/ooxml/officeDocument/relationships":"r","http://purl.oclc.org/ooxml/drawingml/wordprocessingDrawing":"wp","http://purl.oclc.org/ooxml/drawingml/main":"a","http://purl.oclc.org/ooxml/drawingml/picture":"pic","http://schemas.openxmlformats.org/package/2006/content-types":"content-types","http://schemas.openxmlformats.org/package/2006/relationships":"relationships","http://schemas.openxmlformats.org/markup-compatibility/2006":"mc","urn:schemas-microsoft-com:vml":"v","urn:schemas-microsoft-com:office:word":"office-word","http://schemas.microsoft.com/office/word/2010/wordml":"wordml"};function at(e){return An.readString(e,Dn).then(function(r){return it(r)[0]})}function Wn(e,r){return e.exists(r)?e.read(r,"utf-8").then(Xn).then(at):Hn.resolve(null)}function Xn(e){return e.replace(/^\uFEFF/g,"")}function it(e){return e.type==="element"?e.name==="mc:AlternateContent"?e.firstOrEmpty("mc:Fallback").children:(e.children=qn.flatten(e.children.map(it,!0)),[e]):[e]}var fr={},mr={};mr.uriToZipEntryName=Ln;mr.replaceFragment=jn;function Ln(e,r){return r.charAt(0)==="/"?r.substr(1):e+"/"+r}function jn(e,r){var t=e.indexOf("#");return t!==-1&&(e=e.substring(0,t)),e+"#"+r}fr.createBodyReader=Vn;fr._readNumberingProperties=lt;var Sr=Yt,K=$,B=E,ut=Z.Result,ee=Z.warning,Un=te,Ir=mr;function Vn(e){return{readXmlElement:function(r){return new Or(e).readXmlElement(r)},readXmlElements:function(r){return new Or(e).readXmlElements(r)}}}function Or(e){var r=[],t=[],a=[],i=e.relationships,o=e.contentTypes,s=e.docxFile,c=e.files,f=e.numbering,d=e.styles;function p(n){var m=n.map(T);return Pr(m)}function T(n){if(n.type==="element"){var m=Je[n.name];if(m)return m(n);if(!Object.prototype.hasOwnProperty.call(zn,n.name)){var v=ee("An unrecognised element was ignored: "+n.name);return be([v])}}return Te()}function N(n){return se(n).map(function(m){return{type:"paragraphProperties",styleId:m.styleId,styleName:m.name,alignment:n.firstOrEmpty("w:jc").attributes["w:val"],numbering:lt(m.styleId,n.firstOrEmpty("w:numPr"),f),indent:H(n.firstOrEmpty("w:ind"))}})}function H(n){return{start:n.attributes["w:start"]||n.attributes["w:left"],end:n.attributes["w:end"]||n.attributes["w:right"],firstLine:n.attributes["w:firstLine"],hanging:n.attributes["w:hanging"]}}function O(n){return oe(n).map(function(m){var v=n.firstOrEmpty("w:sz").attributes["w:val"],b=/^[0-9]+$/.test(v)?parseInt(v,10)/2:null;return{type:"runProperties",styleId:m.styleId,styleName:m.name,verticalAlignment:n.firstOrEmpty("w:vertAlign").attributes["w:val"],font:n.firstOrEmpty("w:rFonts").attributes["w:ascii"],fontSize:b,isBold:R(n.first("w:b")),isUnderline:g(n.first("w:u")),isItalic:R(n.first("w:i")),isStrikethrough:R(n.first("w:strike")),isAllCaps:R(n.first("w:caps")),isSmallCaps:R(n.first("w:smallCaps")),highlight:ie(n.firstOrEmpty("w:highlight").attributes["w:val"])}})}function g(n){if(n){var m=n.attributes["w:val"];return m!==void 0&&m!=="false"&&m!=="0"&&m!=="none"}else return!1}function R(n){if(n){var m=n.attributes["w:val"];return m!=="false"&&m!=="0"}else return!1}function A(n){return n!=="false"&&n!=="0"}function ie(n){return!n||n==="none"?null:n}function se(n){return P(n,"w:pStyle","Paragraph",d.findParagraphStyleById)}function oe(n){return P(n,"w:rStyle","Run",d.findCharacterStyleById)}function ue(n){return P(n,"w:tblStyle","Table",d.findTableStyleById)}function P(n,m,v,b){var I=[],C=n.first(m),X=null,me=null;if(C&&(X=C.attributes["w:val"],X)){var Er=b(X);Er?me=Er.name:I.push(jt(v,X))}return Pe({styleId:X,name:me},I)}function L(n){var m=n.attributes["w:fldCharType"];if(m==="begin")r.push({type:"begin",fldChar:n}),t=[];else if(m==="end"){var v=r.pop();if(v.type==="begin"&&(v=ce(v)),v.type==="checkbox")return U(B.checkbox({checked:v.checked}))}else if(m==="separate"){var b=r.pop(),I=ce(b);r.push(I)}return Te()}function ge(){var n=K.last(r.filter(function(m){return m.type==="hyperlink"}));return n?n.options:null}function ce(n){return fe(t.join(""),n.type==="begin"?n.fldChar:Un.emptyElement)}function fe(n,m){var v=/\s*HYPERLINK "(.*)"/.exec(n);if(v)return{type:"hyperlink",options:{href:v[1]}};var b=/\s*HYPERLINK\s+\\l\s+"(.*)"/.exec(n);if(b)return{type:"hyperlink",options:{anchor:b[1]}};var I=/\s*FORMCHECKBOX\s*/.exec(n);if(I){var C=m.firstOrEmpty("w:ffData").firstOrEmpty("w:checkBox"),X=C.first("w:checked"),me=X==null?R(C.first("w:default")):R(X);return{type:"checkbox",checked:me}}return{type:"unknown"}}function we(n){return t.push(n.text()),Te()}function Ye(n){var m=n.attributes["w:font"],v=n.attributes["w:char"],b=Sr.hex(m,v);return b==null&&/^F0..$/.test(v)&&(b=Sr.hex(m,v.substring(2))),b==null?be([ee("A w:sym element with an unsupported character was ignored: char "+v+" in font "+m)]):U(new B.Text(b.string))}function Ie(n){return function(m){var v=m.attributes["w:id"];return U(new B.NoteReference({noteType:n,noteId:v}))}}function Oe(n){return U(B.commentReference({commentId:n.attributes["w:id"]}))}function j(n){return p(n.children)}var Je={"w:p":function(n){var m=n.firstOrEmpty("w:pPr"),v=!!m.firstOrEmpty("w:rPr").first("w:del");if(v)return n.children.forEach(function(I){a.push(I)}),Te();var b=n.children;return a.length>0&&(b=a.concat(b),a=[]),M.map(N(m),p(b),function(I,C){return new B.Paragraph(C,I)}).insertExtra()},"w:r":function(n){return M.map(O(n.firstOrEmpty("w:rPr")),p(n.children),function(m,v){var b=ge();return b!==null&&(v=[new B.Hyperlink(v,b)]),new B.Run(v,m)})},"w:fldChar":L,"w:instrText":we,"w:t":function(n){return U(new B.Text(n.text()))},"w:tab":function(n){return U(new B.Tab)},"w:noBreakHyphen":function(){return U(new B.Text("‑"))},"w:softHyphen":function(n){return U(new B.Text("­"))},"w:sym":Ye,"w:hyperlink":function(n){var m=n.attributes["r:id"],v=n.attributes["w:anchor"];return p(n.children).map(function(b){function I(X){var me=n.attributes["w:tgtFrame"]||null;return new B.Hyperlink(b,K.extend({targetFrame:me},X))}if(m){var C=i.findTargetByRelationshipId(m);return v&&(C=Ir.replaceFragment(C,v)),I({href:C})}else return v?I({anchor:v}):b})},"w:tbl":Qe,"w:tr":h,"w:tc":y,"w:footnoteReference":Ie("footnote"),"w:endnoteReference":Ie("endnote"),"w:commentReference":Oe,"w:br":function(n){var m=n.attributes["w:type"];return m==null||m==="textWrapping"?U(B.lineBreak):m==="page"?U(B.pageBreak):m==="column"?U(B.columnBreak):be([ee("Unsupported break type: "+m)])},"w:bookmarkStart":function(n){var m=n.attributes["w:name"];return m==="_GoBack"?Te():U(new B.BookmarkStart({name:m}))},"mc:AlternateContent":function(n){return j(n.firstOrEmpty("mc:Fallback"))},"w:sdt":function(n){var m=n.firstOrEmpty("w:sdtPr").first("wordml:checkbox");if(m){var v=m.first("wordml:checked"),b=!!v&&A(v.attributes["wordml:val"]);return U(B.checkbox({checked:b}))}else return p(n.firstOrEmpty("w:sdtContent").children)},"w:ins":j,"w:object":j,"w:smartTag":j,"w:drawing":j,"w:pict":function(n){return j(n).toExtra()},"v:roundrect":j,"v:shape":j,"v:textbox":j,"w:txbxContent":j,"wp:inline":S,"wp:anchor":S,"v:imagedata":Lt,"v:group":j,"v:rect":j};return{readXmlElement:T,readXmlElements:p};function Qe(n){var m=u(n.firstOrEmpty("w:tblPr"));return p(n.children).flatMap(k).flatMap(function(v){return m.map(function(b){return B.Table(v,b)})})}function u(n){return ue(n).map(function(m){return{styleId:m.styleId,styleName:m.name}})}function h(n){var m=n.firstOrEmpty("w:trPr"),v=!!m.first("w:tblHeader");return p(n.children).map(function(b){return B.TableRow(b,{isHeader:v})})}function y(n){return p(n.children).map(function(m){var v=n.firstOrEmpty("w:tcPr"),b=v.firstOrEmpty("w:gridSpan").attributes["w:val"],I=b?parseInt(b,10):1,C=B.TableCell(m,{colSpan:I});return C._vMerge=w(v),C})}function w(n){var m=n.first("w:vMerge");if(m){var v=m.attributes["w:val"];return v==="continue"||!v}else return null}function k(n){var m=K.any(n,function(I){return I.type!==B.types.tableRow});if(m)return Pe(n,[ee("unexpected non-row element in table, cell merging may be incorrect")]);var v=K.any(n,function(I){return K.any(I.children,function(C){return C.type!==B.types.tableCell})});if(v)return Pe(n,[ee("unexpected non-cell element in table row, cell merging may be incorrect")]);var b={};return n.forEach(function(I){var C=0;I.children.forEach(function(X){X._vMerge&&b[C]?b[C].rowSpan++:(b[C]=X,X._vMerge=!1),C+=X.colSpan})}),n.forEach(function(I){I.children=I.children.filter(function(C){return!C._vMerge}),I.children.forEach(function(C){delete C._vMerge})}),U(n)}function S(n){var m=n.getElementsByTagName("a:graphic").getElementsByTagName("a:graphicData").getElementsByTagName("pic:pic").getElementsByTagName("pic:blipFill").getElementsByTagName("a:blip");return Pr(m.map(W.bind(null,n)))}function W(n,m){var v=n.first("wp:docPr").attributes,b=Q(v.descr)?v.title:v.descr,I=G(m);return I===null?be([ee("Could not find image file for a:blip element")]):Tr(I,b)}function Q(n){return n==null||/^\s*$/.test(n)}function G(n){var m=n.attributes["r:embed"],v=n.attributes["r:link"];if(m)return br(m);if(v){var b=i.findTargetByRelationshipId(v);return{path:b,read:c.read.bind(c,b)}}else return null}function Lt(n){var m=n.attributes["r:id"];return m?Tr(br(m),n.attributes["o:title"]):be([ee("A v:imagedata element without a relationship ID was ignored")])}function br(n){var m=Ir.uriToZipEntryName("word",i.findTargetByRelationshipId(n));return{path:m,read:s.read.bind(s,m)}}function Tr(n,m){var v=o.findContentType(n.path),b=B.Image({readImage:n.read,altText:m,contentType:v}),I=Zn[v]?[]:ee("Image of type "+v+" is unlikely to display in web browsers");return Pe(b,I)}function jt(n,m){return ee(n+" style with ID "+m+" was referenced but not defined in the document")}}function lt(e,r,t){var a=r.firstOrEmpty("w:ilvl").attributes["w:val"],i=r.firstOrEmpty("w:numId").attributes["w:val"];if(a!==void 0&&i!==void 0)return t.findLevel(i,a);if(e!=null){var o=t.findLevelByParagraphStyleId(e);if(o!=null)return o}return null}var Zn={"image/png":!0,"image/gif":!0,"image/jpeg":!0,"image/svg+xml":!0,"image/tiff":!0},zn={"office-word:wrap":!0,"v:shadow":!0,"v:shapetype":!0,"w:annotationRef":!0,"w:bookmarkEnd":!0,"w:sectPr":!0,"w:proofErr":!0,"w:lastRenderedPageBreak":!0,"w:commentRangeStart":!0,"w:commentRangeEnd":!0,"w:del":!0,"w:footnoteRef":!0,"w:endnoteRef":!0,"w:pPr":!0,"w:rPr":!0,"w:tblPr":!0,"w:tblGrid":!0,"w:trPr":!0,"w:tcPr":!0};function be(e){return new M(null,null,e)}function Te(){return new M(null)}function U(e){return new M(e)}function Pe(e,r){return new M(e,null,r)}function M(e,r,t){this.value=e||[],this.extra=r||[],this._result=new ut({element:this.value,extra:r},t),this.messages=this._result.messages}M.prototype.toExtra=function(){return new M(null,We(this.extra,this.value),this.messages)};M.prototype.insertExtra=function(){var e=this.extra;return e&&e.length?new M(We(this.value,e),null,this.messages):this};M.prototype.map=function(e){var r=this._result.map(function(t){return e(t.element)});return new M(r.value,this.extra,r.messages)};M.prototype.flatMap=function(e){var r=this._result.flatMap(function(t){return e(t.element)._result});return new M(r.value.element,We(this.extra,r.value.extra),r.messages)};M.map=function(e,r,t){return new M(t(e.value,r.value),We(e.extra,r.extra),e.messages.concat(r.messages))};function Pr(e){var r=ut.combine(K.pluck(e,"_result"));return new M(K.flatten(K.pluck(r.value,"element")),K.filter(K.flatten(K.pluck(r.value,"extra")),Kn),r.messages)}function We(e,r){return K.flatten([e,r])}function Kn(e){return e}var st={};st.DocumentXmlReader=Jn;var Gn=E,Yn=Z.Result;function Jn(e){var r=e.bodyReader;function t(a){var i=a.first("w:body");if(i==null)throw new Error("Could not find the body element: are you sure this is a docx file?");var o=r.readXmlElements(i.children).map(function(s){return new Gn.Document(s,{notes:e.notes,comments:e.comments})});return new Yn(o.value,o.messages)}return{convertXmlToDocument:t}}var Xe={};Xe.readRelationships=Qn;Xe.defaultValue=new pr([]);Xe.Relationships=pr;function Qn(e){var r=[];return e.children.forEach(function(t){if(t.name==="relationships:Relationship"){var a={relationshipId:t.attributes.Id,target:t.attributes.Target,type:t.attributes.Type};r.push(a)}}),new pr(r)}function pr(e){var r={};e.forEach(function(a){r[a.relationshipId]=a.target});var t={};return e.forEach(function(a){t[a.type]||(t[a.type]=[]),t[a.type].push(a.target)}),{findTargetByRelationshipId:function(a){return r[a]},findTargetsByType:function(a){return t[a]||[]}}}var dr={};dr.readContentTypesFromXml=ra;var ea={png:"png",gif:"gif",jpeg:"jpeg",jpg:"jpeg",tif:"tiff",tiff:"tiff",bmp:"bmp"};dr.defaultContentTypes=ot({},{});function ra(e){var r={},t={};return e.children.forEach(function(a){if(a.name==="content-types:Default"&&(r[a.attributes.Extension]=a.attributes.ContentType),a.name==="content-types:Override"){var i=a.attributes.PartName;i.charAt(0)==="/"&&(i=i.substring(1)),t[i]=a.attributes.ContentType}}),ot(t,r)}function ot(e,r){return{findContentType:function(t){var a=e[t];if(a)return a;var i=t.split("."),o=i[i.length-1];if(r.hasOwnProperty(o))return r[o];var s=ea[o.toLowerCase()];return s?"image/"+s:null}}}var Le={},Ne=$;Le.readNumberingXml=ta;Le.Numbering=hr;Le.defaultNumbering=new hr({},{});function hr(e,r,t){var a=Ne.flatten(Ne.values(r).map(function(c){return Ne.values(c.levels)})),i=Ne.indexBy(a.filter(function(c){return c.paragraphStyleId!=null}),"paragraphStyleId");function o(c,f){var d=e[c];if(d){var p=r[d.abstractNumId];if(p){if(p.numStyleLink==null)return r[d.abstractNumId].levels[f];var T=t.findNumberingStyleById(p.numStyleLink);return o(T.numId,f)}else return null}else return null}function s(c){return i[c]||null}return{findLevel:o,findLevelByParagraphStyleId:s}}function ta(e,r){if(!r||!r.styles)throw new Error("styles is missing");var t=na(e),a=ia(e);return new hr(a,t,r.styles)}function na(e){var r={};return e.getElementsByTagName("w:abstractNum").forEach(function(t){var a=t.attributes["w:abstractNumId"];r[a]=aa(t)}),r}function aa(e){var r={};e.getElementsByTagName("w:lvl").forEach(function(a){var i=a.attributes["w:ilvl"],o=a.firstOrEmpty("w:numFmt").attributes["w:val"],s=a.firstOrEmpty("w:pStyle").attributes["w:val"];r[i]={isOrdered:o!=="bullet",level:i,paragraphStyleId:s}});var t=e.firstOrEmpty("w:numStyleLink").attributes["w:val"];return{levels:r,numStyleLink:t}}function ia(e){var r={};return e.getElementsByTagName("w:num").forEach(function(t){var a=t.attributes["w:numId"],i=t.first("w:abstractNumId").attributes["w:val"];r[a]={abstractNumId:i}}),r}var je={};je.readStylesXml=ua;je.Styles=ke;je.defaultStyles=new ke({},{});function ke(e,r,t,a){return{findParagraphStyleById:function(i){return e[i]},findCharacterStyleById:function(i){return r[i]},findTableStyleById:function(i){return t[i]},findNumberingStyleById:function(i){return a[i]}}}ke.EMPTY=new ke({},{},{},{});function ua(e){var r={},t={},a={},i={},o={paragraph:r,character:t,table:a};return e.getElementsByTagName("w:style").forEach(function(s){var c=la(s);if(c.type==="numbering")i[c.styleId]=oa(s);else{var f=o[c.type];f&&(f[c.styleId]=c)}}),new ke(r,t,a,i)}function la(e){var r=e.attributes["w:type"],t=e.attributes["w:styleId"],a=sa(e);return{type:r,styleId:t,name:a}}function sa(e){var r=e.first("w:name");return r?r.attributes["w:val"]:null}function oa(e){var r=e.firstOrEmpty("w:pPr").firstOrEmpty("w:numPr").firstOrEmpty("w:numId").attributes["w:val"];return{numId:r}}var vr={},ca=E,fa=Z.Result;vr.createFootnotesReader=ct.bind(Kr,"footnote");vr.createEndnotesReader=ct.bind(Kr,"endnote");function ct(e,r){function t(o){return fa.combine(o.getElementsByTagName("w:"+e).filter(a).map(i))}function a(o){var s=o.attributes["w:type"];return s!=="continuationSeparator"&&s!=="separator"}function i(o){var s=o.attributes["w:id"];return r.readXmlElements(o.children).map(function(c){return ca.Note({noteType:e,noteId:s,body:c})})}return t}var ft={},ma=E,pa=Z.Result;function da(e){function r(a){return pa.combine(a.getElementsByTagName("w:comment").map(t))}function t(a){var i=a.attributes["w:id"];function o(s){return(a.attributes[s]||"").trim()||null}return e.readXmlElements(a.children).map(function(s){return ma.comment({commentId:i,body:s,authorName:o("w:author"),authorInitials:o("w:initials")})})}return r}ft.createCommentsReader=da;var mt={},ha=_;mt.Files=va;function va(){function e(r){return ha.reject(new Error("could not open external image: '"+r+`'
cannot open linked files from a web browser`))}return{read:e}}ur.read=Ea;ur._findPartPaths=dt;var ya=_,ga=E,rr=Z.Result,Me=Re,pt=or.readXmlFromZipFile,wa=fr.createBodyReader,ba=st.DocumentXmlReader,de=Xe,Nr=dr,Cr=Le,Br=je,$r=vr,Ta=ft,_r=mt.Files;function Ea(e,r){return r=r||{},ya.props({contentTypes:xa(e),partPaths:dt(e),docxFile:e,files:r.path?_r.relativeToFile(r.path):new _r(null)}).also(function(t){return{styles:Sa(e,t.partPaths.styles)}}).also(function(t){return{numbering:Ra(e,t.partPaths.numbering,t.styles)}}).also(function(t){return{footnotes:Ce(t.partPaths.footnotes,t,function(a,i){return i?$r.createFootnotesReader(a)(i):new rr([])}),endnotes:Ce(t.partPaths.endnotes,t,function(a,i){return i?$r.createEndnotesReader(a)(i):new rr([])}),comments:Ce(t.partPaths.comments,t,function(a,i){return i?Ta.createCommentsReader(a)(i):new rr([])})}}).also(function(t){return{notes:t.footnotes.flatMap(function(a){return t.endnotes.map(function(i){return new ga.Notes(a.concat(i))})})}}).then(function(t){return Ce(t.partPaths.mainDocument,t,function(a,i){return t.notes.flatMap(function(o){return t.comments.flatMap(function(s){var c=new ba({bodyReader:a,notes:o,comments:s});return c.convertXmlToDocument(i)})})})})}function dt(e){return Ia(e).then(function(r){var t=Mr({docxFile:e,relationships:r,relationshipType:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",basePath:"",fallbackPath:"word/document.xml"});if(!e.exists(t))throw new Error("Could not find main document part. Are you sure this is a valid .docx file?");return ye({filename:ht(t),readElement:de.readRelationships,defaultValue:de.defaultValue})(e).then(function(a){function i(o){return Mr({docxFile:e,relationships:a,relationshipType:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/"+o,basePath:Me.splitPath(t).dirname,fallbackPath:"word/"+o+".xml"})}return{mainDocument:t,comments:i("comments"),endnotes:i("endnotes"),footnotes:i("footnotes"),numbering:i("numbering"),styles:i("styles")}})})}function Mr(e){var r=e.docxFile,t=e.relationships,a=e.relationshipType,i=e.basePath,o=e.fallbackPath,s=t.findTargetsByType(a),c=s.map(function(d){return ka(Me.joinPath(i,d),"/")}),f=c.filter(function(d){return r.exists(d)});return f.length===0?o:f[0]}function ka(e,r){return e.substring(0,r.length)===r?e.substring(r.length):e}function ye(e){return function(r){return pt(r,e.filename).then(function(t){return t?e.readElement(t):e.defaultValue})}}function Ce(e,r,t){var a=ye({filename:ht(e),readElement:de.readRelationships,defaultValue:de.defaultValue});return a(r.docxFile).then(function(i){var o=new wa({relationships:i,contentTypes:r.contentTypes,docxFile:r.docxFile,numbering:r.numbering,styles:r.styles,files:r.files});return pt(r.docxFile,e).then(function(s){return t(o,s)})})}function ht(e){var r=Me.splitPath(e);return Me.joinPath(r.dirname,"_rels",r.basename+".rels")}var xa=ye({filename:"[Content_Types].xml",readElement:Nr.readContentTypesFromXml,defaultValue:Nr.defaultContentTypes});function Ra(e,r,t){return ye({filename:r,readElement:function(a){return Cr.readNumberingXml(a,{styles:t})},defaultValue:Cr.defaultNumbering})(e)}function Sa(e,r){return ye({filename:r,readElement:Br.readStylesXml,defaultValue:Br.defaultStyles})(e)}var Ia=ye({filename:"_rels/.rels",readElement:de.readRelationships,defaultValue:de.defaultValue}),yr={},Oa=$,Pa=_,xe=te;yr.writeStyleMap=Ca;yr.readStyleMap=_a;var Na="http://schemas.zwobble.org/mammoth/style-map",Fe="mammoth/style-map",vt="/"+Fe;function Ca(e,r){return e.write(Fe,r),Ba(e).then(function(){return $a(e)})}function Ba(e){var r="word/_rels/document.xml.rels",t="http://schemas.openxmlformats.org/package/2006/relationships",a="{"+t+"}Relationship";return e.read(r,"utf8").then(xe.readString).then(function(i){var o=i.children;yt(o,a,"Id",{Id:"rMammothStyleMap",Type:Na,Target:vt});var s={"":t};return e.write(r,xe.writeString(i,s))})}function $a(e){var r="[Content_Types].xml",t="http://schemas.openxmlformats.org/package/2006/content-types",a="{"+t+"}Override";return e.read(r,"utf8").then(xe.readString).then(function(i){var o=i.children;yt(o,a,"PartName",{PartName:vt,ContentType:"text/prs.mammoth.style-map"});var s={"":t};return e.write(r,xe.writeString(i,s))})}function yt(e,r,t,a){var i=Oa.find(e,function(o){return o.name===r&&o.attributes[t]===a[t]});i?i.attributes=a:e.push(xe.element(r,a))}function _a(e){return e.exists(Fe)?e.read(Fe,"utf8"):Pa.resolve(null)}var gr={},le={},re={},ne={},Fr;function gt(){if(Fr)return ne;Fr=1;var e=Ve();function r(f,d,p){return a(e.element(f,d,{fresh:!1}),p)}function t(f,d,p){var T=e.element(f,d,{fresh:!0});return a(T,p)}function a(f,d){return{type:"element",tag:f,children:d||[]}}function i(f){return{type:"text",value:f}}var o={type:"forceWrite"};ne.freshElement=t,ne.nonFreshElement=r,ne.elementWithTag=a,ne.text=i,ne.forceWrite=o;var s={br:!0,hr:!0,img:!0,input:!0};function c(f){return f.children.length===0&&s[f.tag.tagName]}return ne.isVoidElement=c,ne}var tr,qr;function Ma(){if(qr)return tr;qr=1;var e=$,r=gt();function t(g){return a(d(g))}function a(g){var R=[];return g.map(i).forEach(function(A){f(R,A)}),R}function i(g){return o[g.type](g)}var o={element:s,text:c,forceWrite:c};function s(g){return r.elementWithTag(g.tag,a(g.children))}function c(g){return g}function f(g,R){var A=g[g.length-1];R.type==="element"&&!R.tag.fresh&&A&&A.type==="element"&&R.tag.matchesElement(A.tag)?(R.tag.separator&&f(A.children,r.text(R.tag.separator)),R.children.forEach(function(ie){f(A.children,ie)})):g.push(R)}function d(g){return p(g,function(R){return T[R.type](R)})}function p(g,R){return e.flatten(e.map(g,R),!0)}var T={element:H,text:O,forceWrite:N};function N(g){return[g]}function H(g){var R=d(g.children);return R.length===0&&!r.isVoidElement(g)?[]:[r.elementWithTag(g.tag,R)]}function O(g){return g.value.length===0?[]:[g]}return tr=t,tr}var Hr;function Ue(){if(Hr)return re;Hr=1;var e=gt();re.freshElement=e.freshElement,re.nonFreshElement=e.nonFreshElement,re.elementWithTag=e.elementWithTag,re.text=e.text,re.forceWrite=e.forceWrite,re.simplify=Ma();function r(s,c){c.forEach(function(f){t(s,f)})}function t(s,c){a[c.type](s,c)}var a={element:i,text:o,forceWrite:function(){}};function i(s,c){e.isVoidElement(c)?s.selfClosing(c.tag.tagName,c.tag.attributes):(s.open(c.tag.tagName,c.tag.attributes),r(s,c.children),s.close(c.tag.tagName))}function o(s,c){s.text(c.value)}return re.write=r,re}var Ar;function Ve(){if(Ar)return le;Ar=1;var e=$,r=Ue();le.topLevelElement=t,le.elements=a,le.element=o;function t(c,f){return a([o(c,f,{fresh:!0})])}function a(c){return new i(c.map(function(f){return e.isString(f)?o(f):f}))}function i(c){this._elements=c}i.prototype.wrap=function(f){for(var d=f(),p=this._elements.length-1;p>=0;p--)d=this._elements[p].wrapNodes(d);return d};function o(c,f,d){return d=d||{},new s(c,f,d)}function s(c,f,d){var p={};e.isArray(c)?(c.forEach(function(T){p[T]=!0}),c=c[0]):p[c]=!0,this.tagName=c,this.tagNames=p,this.attributes=f||{},this.fresh=d.fresh,this.separator=d.separator}return s.prototype.matchesElement=function(c){return this.tagNames[c.tagName]&&e.isEqual(this.attributes||{},c.attributes||{})},s.prototype.wrap=function(f){return this.wrapNodes(f())},s.prototype.wrapNodes=function(f){return[r.elementWithTag(this,f)]},le.empty=a([]),le.ignore={wrap:function(){return[]}},le}var wt={};(function(e){var r=$,t=_,a=Ue();e.imgElement=i;function i(o){return function(s,c){return t.when(o(s)).then(function(f){var d={};return s.altText&&(d.alt=s.altText),r.extend(d,f),[a.freshElement("img",d)]})}}e.inline=e.imgElement,e.dataUri=i(function(o){return o.readAsBase64String().then(function(s){return{src:"data:"+o.contentType+";base64,"+s}})})})(wt);var bt={},Tt={},Et=$;Tt.writer=Fa;function Fa(e){return e=e||{},e.prettyPrint?qa():kt()}var Be={div:!0,p:!0,ul:!0,li:!0};function qa(){var e=0,r="  ",t=[],a=!0,i=!1,o=kt();function s(O,g){Be[O]&&N(),t.push(O),o.open(O,g),Be[O]&&e++,a=!1}function c(O){Be[O]&&(e--,N()),t.pop(),o.close(O)}function f(O){T();var g=H()?O:O.replace(`
`,`
`+r);o.text(g)}function d(O,g){N(),o.selfClosing(O,g)}function p(){return t.length===0||Be[t[t.length-1]]}function T(){i||(N(),i=!0)}function N(){if(i=!1,!a&&p()&&!H()){o._append(`
`);for(var O=0;O<e;O++)o._append(r)}}function H(){return Et.some(t,function(O){return O==="pre"})}return{asString:o.asString,open:s,close:c,text:f,selfClosing:d}}function kt(){var e=[];function r(f,d){var p=i(d);e.push("<"+f+p+">")}function t(f){e.push("</"+f+">")}function a(f,d){var p=i(d);e.push("<"+f+p+" />")}function i(f){return Et.map(f,function(d,p){return" "+p+'="'+Aa(d)+'"'}).join("")}function o(f){e.push(Ha(f))}function s(f){e.push(f)}function c(){return e.join("")}return{asString:c,open:r,close:t,text:o,selfClosing:a,_append:s}}function Ha(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function Aa(e){return e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}var xt={},Da=$;function Dr(e){return qe(e,e)}function qe(e,r){return function(){return{start:e,end:r}}}function Wa(e){var r=e.href||"";return r?{start:"[",end:"]("+r+")",anchorPosition:"before"}:{}}function Xa(e){var r=e.src||"",t=e.alt||"";return r||t?{start:"!["+t+"]("+r+")"}:{}}function Wr(e){return function(r,t){return{start:t?`
`:"",end:t?"":`
`,list:{isOrdered:e.isOrdered,indent:t?t.indent+1:0,count:0}}}}function La(e,r,t){r=r||{indent:0,isOrdered:!1,count:0},r.count++,t.hasClosed=!1;var a=r.isOrdered?r.count+".":"-",i=St("	",r.indent)+a+" ";return{start:i,end:function(){if(!t.hasClosed)return t.hasClosed=!0,`
`}}}var Rt={p:qe("",`

`),br:qe("",`  
`),ul:Wr({isOrdered:!1}),ol:Wr({isOrdered:!0}),li:La,strong:Dr("__"),em:Dr("*"),a:Wa,img:Xa};(function(){for(var e=1;e<=6;e++)Rt["h"+e]=qe(St("#",e)+" ",`

`)})();function St(e,r){return new Array(r+1).join(e)}function ja(){var e=[],r=[],t=null,a={};function i(p,T){T=T||{};var N=Rt[p]||function(){return{}},H=N(T,t,a);r.push({end:H.end,list:t}),H.list&&(t=H.list);var O=H.anchorPosition==="before";O&&o(T),e.push(H.start||""),O||o(T)}function o(p){p.id&&e.push('<a id="'+p.id+'"></a>')}function s(p){var T=r.pop();t=T.list;var N=Da.isFunction(T.end)?T.end():T.end;e.push(N||"")}function c(p,T){i(p,T),s()}function f(p){e.push(Ua(p))}function d(){return e.join("")}return{asString:d,open:i,close:s,text:f,selfClosing:c}}xt.writer=ja;function Ua(e){return e.replace(/\\/g,"\\\\").replace(/([\`\*_\{\}\[\]\(\)\#\+\-\.\!])/g,"\\$1")}var Va=Tt,Za=xt;bt.writer=za;function za(e){return e=e||{},e.outputFormat==="markdown"?Za.writer():Va.writer(e)}var ae=$,Xr=_,$e=E,z=Ve(),ir=Z,Ka=wt,x=Ue(),Ga=bt;gr.DocumentConverter=Ya;function Ya(e){return{convertToHtml:function(r){var t=ae.indexBy(r.type===$e.types.document?r.comments:[],"commentId"),a=new Ja(e,t);return a.convertToHtml(r)}}}function Ja(e,r){var t=1,a=[],i=[];e=ae.extend({ignoreEmptyParagraphs:!0},e);var o=e.idPrefix===void 0?"":e.idPrefix,s=e.ignoreEmptyParagraphs,c=z.topLevelElement("p"),f=e.styleMap||[];function d(u){var h=[],y=T(u,h,{}),w=[];It(y,function(S){S.type==="deferred"&&w.push(S)});var k={};return Xr.mapSeries(w,function(S){return S.value().then(function(W){k[S.id]=W})}).then(function(){function S(Q){return nr(Q,function(G){return G.type==="deferred"?k[G.id]:G.children?[ae.extend({},G,{children:S(G.children)})]:[G]})}var W=Ga.writer({prettyPrint:e.prettyPrint,outputFormat:e.outputFormat});return x.write(W,x.simplify(S(y))),new ir.Result(W.asString(),h)})}function p(u,h,y){return nr(u,function(w){return T(w,h,y)})}function T(u,h,y){if(!y)throw new Error("options not set");var w=Qe[u.type];return w?w(u,h,y):[]}function N(u,h,y){return H(u,h).wrap(function(){var w=p(u.children,h,y);return s?w:[x.forceWrite].concat(w)})}function H(u,h){var y=A(u);return y?y.to:(u.styleId&&h.push(Lr("paragraph",u)),c)}function O(u,h,y){var w=function(){return p(u.children,h,y)},k=[];if(u.highlight!==null){var S=R({type:"highlight",color:u.highlight});S&&k.push(S)}u.isSmallCaps&&k.push(g("smallCaps")),u.isAllCaps&&k.push(g("allCaps")),u.isStrikethrough&&k.push(g("strikethrough","s")),u.isUnderline&&k.push(g("underline")),u.verticalAlignment===$e.verticalAlignment.subscript&&k.push(z.element("sub",{},{fresh:!1})),u.verticalAlignment===$e.verticalAlignment.superscript&&k.push(z.element("sup",{},{fresh:!1})),u.isItalic&&k.push(g("italic","em")),u.isBold&&k.push(g("bold","strong"));var W=z.empty,Q=A(u);return Q?W=Q.to:u.styleId&&h.push(Lr("run",u)),k.push(W),k.forEach(function(G){w=G.wrap.bind(G,w)}),w()}function g(u,h){var y=R({type:u});return y||(h?z.element(h,{},{fresh:!1}):z.empty)}function R(u,h){var y=A(u);return y?y.to:h}function A(u){for(var h=0;h<f.length;h++)if(f[h].from.matches(u))return f[h]}function ie(u){return function(h,y){return Xr.attempt(function(){return u(h,y)}).caught(function(w){return y.push(ir.error(w)),[]})}}function se(u){return ue(u.noteType,u.noteId)}function oe(u){return P(u.noteType,u.noteId)}function ue(u,h){return L(u+"-"+h)}function P(u,h){return L(u+"-ref-"+h)}function L(u){return o+u}var ge=z.elements([z.element("table",{},{fresh:!0})]);function ce(u,h,y){return R(u,ge).wrap(function(){return fe(u,h,y)})}function fe(u,h,y){var w=ae.findIndex(u.children,function(Q){return!Q.type===$e.types.tableRow||!Q.isHeader});w===-1&&(w=u.children.length);var k;if(w===0)k=p(u.children,h,ae.extend({},y,{isTableHeader:!1}));else{var S=p(u.children.slice(0,w),h,ae.extend({},y,{isTableHeader:!0})),W=p(u.children.slice(w),h,ae.extend({},y,{isTableHeader:!1}));k=[x.freshElement("thead",{},S),x.freshElement("tbody",{},W)]}return[x.forceWrite].concat(k)}function we(u,h,y){var w=p(u.children,h,y);return[x.freshElement("tr",{},[x.forceWrite].concat(w))]}function Ye(u,h,y){var w=y.isTableHeader?"th":"td",k=p(u.children,h,y),S={};return u.colSpan!==1&&(S.colspan=u.colSpan.toString()),u.rowSpan!==1&&(S.rowspan=u.rowSpan.toString()),[x.freshElement(w,S,[x.forceWrite].concat(k))]}function Ie(u,h,y){return R(u,z.ignore).wrap(function(){var w=r[u.commentId],k=i.length+1,S="["+ri(w)+k+"]";return i.push({label:S,comment:w}),[x.freshElement("a",{href:"#"+ue("comment",u.commentId),id:P("comment",u.commentId)},[x.text(S)])]})}function Oe(u,h,y){var w=u.label,k=u.comment,S=p(k.body,h,y).concat([x.nonFreshElement("p",{},[x.text(" "),x.freshElement("a",{href:"#"+P("comment",k.commentId)},[x.text("↑")])])]);return[x.freshElement("dt",{id:ue("comment",k.commentId)},[x.text("Comment "+w)]),x.freshElement("dd",{},S)]}function j(u,h,y){return Je(u).wrap(function(){return[]})}function Je(u){var h=A(u);return h?h.to:u.breakType==="line"?z.topLevelElement("br"):z.empty}var Qe={document:function(u,h,y){var w=p(u.children,h,y),k=a.map(function(W){return u.notes.resolve(W)}),S=p(k,h,y);return w.concat([x.freshElement("ol",{},S),x.freshElement("dl",{},nr(i,function(W){return Oe(W,h,y)}))])},paragraph:N,run:O,text:function(u,h,y){return[x.text(u.value)]},tab:function(u,h,y){return[x.text("	")]},hyperlink:function(u,h,y){var w=u.anchor?"#"+L(u.anchor):u.href,k={href:w};u.targetFrame!=null&&(k.target=u.targetFrame);var S=p(u.children,h,y);return[x.nonFreshElement("a",k,S)]},checkbox:function(u){var h={type:"checkbox"};return u.checked&&(h.checked="checked"),[x.freshElement("input",h)]},bookmarkStart:function(u,h,y){var w=x.freshElement("a",{id:L(u.name)},[x.forceWrite]);return[w]},noteReference:function(u,h,y){a.push(u);var w=x.freshElement("a",{href:"#"+se(u),id:oe(u)},[x.text("["+t+++"]")]);return[x.freshElement("sup",{},[w])]},note:function(u,h,y){var w=p(u.body,h,y),k=x.elementWithTag(z.element("p",{},{fresh:!1}),[x.text(" "),x.freshElement("a",{href:"#"+oe(u)},[x.text("↑")])]),S=w.concat([k]);return x.freshElement("li",{id:se(u)},S)},commentReference:Ie,comment:Oe,image:ei(ie(e.convertImage||Ka.dataUri)),table:ce,tableRow:we,tableCell:Ye,break:j};return{convertToHtml:d}}var Qa=1;function ei(e){return function(r,t,a){return[{type:"deferred",id:Qa++,value:function(){return e(r,t,a)}}]}}function Lr(e,r){return ir.warning("Unrecognised "+e+" style: '"+r.styleName+"' (Style ID: "+r.styleId+")")}function nr(e,r){return ae.flatten(e.map(r),!0)}function It(e,r){e.forEach(function(t){r(t),t.children&&It(t.children,r)})}var ri=gr.commentAuthorLabel=function(r){return r.authorInitials||""},Ot={},ti=E;function Pt(e){if(e.type==="text")return e.value;if(e.type===ti.types.tab)return"	";var r=e.type==="paragraph"?`

`:"";return(e.children||[]).map(Pt).join("")+r}Ot.convertElementToRawText=Pt;var Ze={},q={};q.paragraph=ni;q.run=ai;q.table=ii;q.bold=new Y("bold");q.italic=new Y("italic");q.underline=new Y("underline");q.strikethrough=new Y("strikethrough");q.allCaps=new Y("allCaps");q.smallCaps=new Y("smallCaps");q.highlight=ui;q.commentReference=new Y("commentReference");q.lineBreak=new ze({breakType:"line"});q.pageBreak=new ze({breakType:"page"});q.columnBreak=new ze({breakType:"column"});q.equalTo=si;q.startsWith=oi;function ni(e){return new Y("paragraph",e)}function ai(e){return new Y("run",e)}function ii(e){return new Y("table",e)}function ui(e){return new Nt(e)}function Y(e,r){r=r||{},this._elementType=e,this._styleId=r.styleId,this._styleName=r.styleName,r.list&&(this._listIndex=r.list.levelIndex,this._listIsOrdered=r.list.isOrdered)}Y.prototype.matches=function(e){return e.type===this._elementType&&(this._styleId===void 0||e.styleId===this._styleId)&&(this._styleName===void 0||e.styleName&&this._styleName.operator(this._styleName.operand,e.styleName))&&(this._listIndex===void 0||li(e,this._listIndex,this._listIsOrdered))&&(this._breakType===void 0||this._breakType===e.breakType)};function Nt(e){e=e||{},this._color=e.color}Nt.prototype.matches=function(e){return e.type==="highlight"&&(this._color===void 0||e.color===this._color)};function ze(e){e=e||{},this._breakType=e.breakType}ze.prototype.matches=function(e){return e.type==="break"&&(this._breakType===void 0||e.breakType===this._breakType)};function li(e,r,t){return e.numbering&&e.numbering.level==r&&e.numbering.isOrdered==t}function si(e){return{operator:ci,operand:e}}function oi(e){return{operator:fi,operand:e}}function ci(e,r){return e.toUpperCase()===r.toUpperCase()}function fi(e,r){return r.toUpperCase().indexOf(e.toUpperCase())===0}var Ct={},mi=zr,pi=mi.RegexTokeniser;Ct.tokenise=di;var jr="'((?:\\\\.|[^'])*)";function di(e){var r="(?:[a-zA-Z\\-_]|\\\\.)",t=new pi([{name:"identifier",regex:new RegExp("("+r+"(?:"+r+"|[0-9])*)")},{name:"dot",regex:/\./},{name:"colon",regex:/:/},{name:"gt",regex:/>/},{name:"whitespace",regex:/\s+/},{name:"arrow",regex:/=>/},{name:"equals",regex:/=/},{name:"startsWith",regex:/\^=/},{name:"open-paren",regex:/\(/},{name:"close-paren",regex:/\)/},{name:"open-square-bracket",regex:/\[/},{name:"close-square-bracket",regex:/\]/},{name:"string",regex:new RegExp(jr+"'")},{name:"unterminated-string",regex:new RegExp(jr)},{name:"integer",regex:/([0-9]+)/},{name:"choice",regex:/\|/},{name:"bang",regex:/(!)/}]);return t.tokenise(e)}var hi=$,l=zr,D=q,_e=Ve(),vi=Ct.tokenise,ar=Z;Ze.readHtmlPath=bi;Ze.readDocumentMatcher=wi;Ze.readStyle=yi;function yi(e){return wr(Oi,e)}function gi(){return l.rules.sequence(l.rules.sequence.capture(Bt()),l.rules.tokenOfType("whitespace"),l.rules.tokenOfType("arrow"),l.rules.sequence.capture(l.rules.optional(l.rules.sequence(l.rules.tokenOfType("whitespace"),l.rules.sequence.capture($t())).head())),l.rules.tokenOfType("end")).map(function(e,r){return{from:e,to:r.valueOrElse(_e.empty)}})}function wi(e){return wr(Bt(),e)}function Bt(){var e=l.rules.sequence,r=function(P,L){return l.rules.then(l.rules.token("identifier",P),function(){return L})},t=r("p",D.paragraph),a=r("r",D.run),i=l.rules.firstOf("p or r or table",t,a),o=l.rules.sequence(l.rules.tokenOfType("dot"),l.rules.sequence.cut(),l.rules.sequence.capture(Ke)).map(function(P){return{styleId:P}}),s=l.rules.firstOf("style name matcher",l.rules.then(l.rules.sequence(l.rules.tokenOfType("equals"),l.rules.sequence.cut(),l.rules.sequence.capture(pe)).head(),function(P){return{styleName:D.equalTo(P)}}),l.rules.then(l.rules.sequence(l.rules.tokenOfType("startsWith"),l.rules.sequence.cut(),l.rules.sequence.capture(pe)).head(),function(P){return{styleName:D.startsWith(P)}})),c=l.rules.sequence(l.rules.tokenOfType("open-square-bracket"),l.rules.sequence.cut(),l.rules.token("identifier","style-name"),l.rules.sequence.capture(s),l.rules.tokenOfType("close-square-bracket")).head(),f=l.rules.firstOf("list type",r("ordered-list",{isOrdered:!0}),r("unordered-list",{isOrdered:!1})),d=e(l.rules.tokenOfType("colon"),e.capture(f),e.cut(),l.rules.tokenOfType("open-paren"),e.capture(Ti),l.rules.tokenOfType("close-paren")).map(function(P,L){return{list:{isOrdered:P.isOrdered,levelIndex:L-1}}});function p(P){var L=l.rules.firstOf.apply(l.rules.firstOf,["matcher suffix"].concat(P)),ge=l.rules.zeroOrMore(L);return l.rules.then(ge,function(ce){var fe={};return ce.forEach(function(we){hi.extend(fe,we)}),fe})}var T=e(e.capture(i),e.capture(p([o,c,d]))).map(function(P,L){return P(L)}),N=e(l.rules.token("identifier","table"),e.capture(p([o,c]))).map(function(P){return D.table(P)}),H=r("b",D.bold),O=r("i",D.italic),g=r("u",D.underline),R=r("strike",D.strikethrough),A=r("all-caps",D.allCaps),ie=r("small-caps",D.smallCaps),se=e(l.rules.token("identifier","highlight"),l.rules.sequence.capture(l.rules.optional(l.rules.sequence(l.rules.tokenOfType("open-square-bracket"),l.rules.sequence.cut(),l.rules.token("identifier","color"),l.rules.tokenOfType("equals"),l.rules.sequence.capture(pe),l.rules.tokenOfType("close-square-bracket")).head()))).map(function(P){return D.highlight({color:P.valueOrElse(void 0)})}),oe=r("comment-reference",D.commentReference),ue=e(l.rules.token("identifier","br"),e.cut(),l.rules.tokenOfType("open-square-bracket"),l.rules.token("identifier","type"),l.rules.tokenOfType("equals"),e.capture(pe),l.rules.tokenOfType("close-square-bracket")).map(function(P){switch(P){case"line":return D.lineBreak;case"page":return D.pageBreak;case"column":return D.columnBreak}});return l.rules.firstOf("element type",T,N,H,O,g,R,A,ie,se,oe,ue)}function bi(e){return wr($t(),e)}function $t(){var e=l.rules.sequence.capture,r=l.rules.tokenOfType("whitespace"),t=l.rules.then(l.rules.optional(l.rules.sequence(l.rules.tokenOfType("colon"),l.rules.token("identifier","fresh"))),function(s){return s.map(function(){return!0}).valueOrElse(!1)}),a=l.rules.then(l.rules.optional(l.rules.sequence(l.rules.tokenOfType("colon"),l.rules.token("identifier","separator"),l.rules.tokenOfType("open-paren"),e(pe),l.rules.tokenOfType("close-paren")).head()),function(s){return s.valueOrElse("")}),i=l.rules.oneOrMoreWithSeparator(Ke,l.rules.tokenOfType("choice")),o=l.rules.sequence(e(i),e(l.rules.zeroOrMore(Ri)),e(t),e(a)).map(function(s,c,f,d){var p={},T={};return c.forEach(function(N){N.append&&p[N.name]?p[N.name]+=" "+N.value:p[N.name]=N.value}),f&&(T.fresh=!0),d&&(T.separator=d),_e.element(s,p,T)});return l.rules.firstOf("html path",l.rules.then(l.rules.tokenOfType("bang"),function(){return _e.ignore}),l.rules.then(l.rules.zeroOrMoreWithSeparator(o,l.rules.sequence(r,l.rules.tokenOfType("gt"),r)),_e.elements))}var Ke=l.rules.then(l.rules.tokenOfType("identifier"),_t),Ti=l.rules.tokenOfType("integer"),pe=l.rules.then(l.rules.tokenOfType("string"),_t),Ei={n:`
`,r:"\r",t:"	"};function _t(e){return e.replace(/\\(.)/g,function(r,t){return Ei[t]||t})}var ki=l.rules.sequence(l.rules.tokenOfType("open-square-bracket"),l.rules.sequence.cut(),l.rules.sequence.capture(Ke),l.rules.tokenOfType("equals"),l.rules.sequence.capture(pe),l.rules.tokenOfType("close-square-bracket")).map(function(e,r){return{name:e,value:r,append:!1}}),xi=l.rules.sequence(l.rules.tokenOfType("dot"),l.rules.sequence.cut(),l.rules.sequence.capture(Ke)).map(function(e){return{name:"class",value:e,append:!0}}),Ri=l.rules.firstOf("attribute or class",ki,xi);function wr(e,r){var t=vi(r),a=l.Parser(),i=a.parseTokens(e,t);return i.isSuccess()?ar.success(i.value()):new ar.Result(null,[ar.warning(Si(r,i))])}function Si(e,r){return"Did not understand this style mapping, so ignored it: "+e+`
`+r.errors().map(Ii).join(`
`)}function Ii(e){return"Error was at character number "+e.characterNumber()+": Expected "+e.expected+" but got "+e.actual}var Oi=gi(),Ge={};Ge.readOptions=Ci;var Mt=$,Pi=Ge._defaultStyleMap=["p.Heading1 => h1:fresh","p.Heading2 => h2:fresh","p.Heading3 => h3:fresh","p.Heading4 => h4:fresh","p.Heading5 => h5:fresh","p.Heading6 => h6:fresh","p[style-name='Heading 1'] => h1:fresh","p[style-name='Heading 2'] => h2:fresh","p[style-name='Heading 3'] => h3:fresh","p[style-name='Heading 4'] => h4:fresh","p[style-name='Heading 5'] => h5:fresh","p[style-name='Heading 6'] => h6:fresh","p[style-name='heading 1'] => h1:fresh","p[style-name='heading 2'] => h2:fresh","p[style-name='heading 3'] => h3:fresh","p[style-name='heading 4'] => h4:fresh","p[style-name='heading 5'] => h5:fresh","p[style-name='heading 6'] => h6:fresh","r[style-name='Strong'] => strong","p[style-name='footnote text'] => p:fresh","r[style-name='footnote reference'] =>","p[style-name='endnote text'] => p:fresh","r[style-name='endnote reference'] =>","p[style-name='annotation text'] => p:fresh","r[style-name='annotation reference'] =>","p[style-name='Footnote'] => p:fresh","r[style-name='Footnote anchor'] =>","p[style-name='Endnote'] => p:fresh","r[style-name='Endnote anchor'] =>","p:unordered-list(1) => ul > li:fresh","p:unordered-list(2) => ul|ol > li > ul > li:fresh","p:unordered-list(3) => ul|ol > li > ul|ol > li > ul > li:fresh","p:unordered-list(4) => ul|ol > li > ul|ol > li > ul|ol > li > ul > li:fresh","p:unordered-list(5) => ul|ol > li > ul|ol > li > ul|ol > li > ul|ol > li > ul > li:fresh","p:ordered-list(1) => ol > li:fresh","p:ordered-list(2) => ul|ol > li > ol > li:fresh","p:ordered-list(3) => ul|ol > li > ul|ol > li > ol > li:fresh","p:ordered-list(4) => ul|ol > li > ul|ol > li > ul|ol > li > ol > li:fresh","p:ordered-list(5) => ul|ol > li > ul|ol > li > ul|ol > li > ul|ol > li > ol > li:fresh","r[style-name='Hyperlink'] =>","p[style-name='Normal'] => p:fresh"],Ni=Ge._standardOptions={transformDocument:Bi,includeDefaultStyleMap:!0,includeEmbeddedStyleMap:!0};function Ci(e){return e=e||{},Mt.extend({},Ni,e,{customStyleMap:Ur(e.styleMap),readStyleMap:function(){var r=this.customStyleMap;return this.includeEmbeddedStyleMap&&(r=r.concat(Ur(this.embeddedStyleMap))),this.includeDefaultStyleMap&&(r=r.concat(Pi)),r}})}function Ur(e){return e?Mt.isString(e)?e.split(`
`).map(function(r){return r.trim()}).filter(function(r){return r!==""&&r.charAt(0)!=="#"}):e:[]}function Bi(e){return e}var Ft={},Vr=_,$i=Re;Ft.openZip=_i;function _i(e){return e.arrayBuffer?Vr.resolve($i.openArrayBuffer(e.arrayBuffer)):Vr.reject(new Error("Could not find file in options"))}var Se={},Zr=$;Se.paragraph=Mi;Se.run=Fi;Se._elements=Ht;Se.getDescendantsOfType=qi;Se.getDescendants=At;function Mi(e){return qt("paragraph",e)}function Fi(e){return qt("run",e)}function qt(e,r){return Ht(function(t){return t.type===e?r(t):t})}function Ht(e){return function r(t){if(t.children){var a=Zr.map(t.children,r);t=Zr.extend(t,{children:a})}return e(t)}}function qi(e,r){return At(e).filter(function(t){return t.type===r})}function At(e){var r=[];return Dt(e,function(t){r.push(t)}),r}function Dt(e,r){e.children&&e.children.forEach(function(t){Dt(t,r),r(t)})}var Hi={},Ai=Ve(),Di=Ue();Hi.element=Wi;function Wi(e){return function(r){return Di.elementWithTag(Ai.element(e),[r])}}var Xi=$,Wt=ur,Li=yr,ji=gr.DocumentConverter,Ui=Ot.convertElementToRawText,Vi=Ze.readStyle,Zi=Ge.readOptions,Xt=Ft,zi=Z.Result,tu=Ki,nu=Qi;function Ki(e,r){return Gi(e,r)}function Gi(e,r){return r=Zi(r),Xt.openZip(e).tap(function(t){return Li.readStyleMap(t).then(function(a){r.embeddedStyleMap=a})}).then(function(t){return Wt.read(t,e).then(function(a){return a.map(r.transformDocument)}).then(function(a){return Yi(a,r)})})}function Yi(e,r){var t=Ji(r.readStyleMap()),a=Xi.extend({},r,{styleMap:t.value}),i=new ji(a);return e.flatMapThen(function(o){return t.flatMapThen(function(s){return i.convertToHtml(o)})})}function Ji(e){return zi.combine((e||[]).map(Vi)).map(function(r){return r.filter(function(t){return!!t})})}function Qi(e){return Xt.openZip(e).then(Wt.read).then(function(r){return r.map(Ui)})}export{tu as c,nu as e};
