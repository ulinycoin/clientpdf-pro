var K=Object.defineProperty;var Y=(c,e,a)=>e in c?K(c,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):c[e]=a;var L=(c,e,a)=>(Y(c,typeof e!="symbol"?e+"":e,a),a);import{r as j,j as t,E as Z,i as G,n as Q,o as X,p as J,k as ee,l as te,D as H,m as se,I as ae,b as U}from"./react-vendor-7056d561.js";import{S as le,t as ne}from"./SEOHead-62068eeb.js";import{u as B,B as O,P as oe,a as re,H as ie,F as ce}from"./index-d5079f2d.js";import{f as de,S as E,P as _,r as M}from"./pdf-lib-vendor-cbec66d4.js";import"./pdfjs-vendor-36642749.js";import{F as me}from"./FileUploadZone-a9764bc0.js";import{r as he,u as V}from"./excel-vendor-af248e40.js";import{f as ue}from"./utils-vendor-4b732c04.js";import{B as ge}from"./Breadcrumbs-eb59f8d6.js";import{R as fe}from"./RelatedTools-29970fb3.js";import{F as xe}from"./FAQSection-00df29a0.js";import{g as pe}from"./faqTranslations-489a9c89.js";import"./vendor-3f6e9ecd.js";import"./router-vendor-bd41c70c.js";const be=({result:c,fileName:e,onDownload:a,onDownloadAll:s,isGenerating:l,onRegenerate:n,onOrientationToggle:d,tableOverflowWarning:r})=>{const[u,o]=j.useState(null),[i,x]=j.useState(!1),[m,h]=j.useState(null),[g,f]=j.useState(1),[p,v]=j.useState(0),b=c?.success?c.pdfFiles:null,w=b?.[p];console.log("🔍 ExcelPreview Debug:",{result:c?{success:c.success,hasFiles:!!c.pdfFiles}:null,pdfFiles:b?b.length:0,currentPdfFile:!!w,isGenerating:l,fileName:e}),j.useEffect(()=>(w?N():P(),P),[w]);const N=async()=>{if(w){x(!0),h(null);try{const y=new Blob([w.data],{type:"application/pdf"}),$=URL.createObjectURL(y);o($)}catch(y){console.error("Error generating preview:",y),h("Failed to generate preview")}finally{x(!1)}}},P=()=>{u&&(URL.revokeObjectURL(u),o(null))},D=()=>{f(y=>Math.min(y+.25,2))},k=()=>{f(y=>Math.max(y-.25,.5))},F=y=>{b&&y>=0&&y<b.length&&v(y)};return l?t.jsx("div",{className:"border border-gray-200 rounded-lg p-6 bg-gray-50",children:t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto mb-3"}),t.jsx("p",{className:"text-gray-600",children:"Generating Excel PDF preview..."}),t.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Processing spreadsheet data..."})]})})}):!c||!c.success?t.jsx("div",{className:"border border-gray-200 rounded-lg p-6 bg-gray-50",children:t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsxs("div",{className:"text-center text-gray-500",children:[t.jsx(Z,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),t.jsx("p",{children:"PDF preview will appear here"}),t.jsx("p",{className:"text-sm",children:"Upload an Excel file and convert to see preview"})]})})}):m?t.jsx("div",{className:"border border-red-200 rounded-lg p-6 bg-red-50",children:t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsxs("div",{className:"text-center text-red-600",children:[t.jsx(G,{className:"w-12 h-12 mx-auto mb-3"}),t.jsx("p",{className:"font-medium",children:"Preview Error"}),t.jsx("p",{className:"text-sm",children:m}),n&&t.jsx("button",{onClick:n,className:"mt-3 text-sm text-red-600 hover:text-red-800 underline",children:"Try again"})]})})}):t.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden bg-white",children:[r?.isOverflowing&&t.jsx("div",{className:"bg-yellow-50 border-b border-yellow-200 p-4",children:t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx(Q,{className:"w-5 h-5 text-yellow-600 mt-0.5 flex-shrink-0"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("h4",{className:"font-medium text-yellow-800 mb-1",children:"Table Layout Warning"}),t.jsxs("p",{className:"text-sm text-yellow-700 mb-2",children:["Your table has ",r.columnCount," columns which may be too wide for optimal display.",r.scaleFactor&&r.scaleFactor<.7&&` Text has been scaled to ${Math.round(r.scaleFactor*100)}% to fit.`]}),t.jsxs("div",{className:"flex flex-wrap gap-2",children:[r.recommendedOrientation&&d&&t.jsxs("button",{onClick:d,className:"flex items-center gap-1 px-3 py-1 bg-yellow-100 text-yellow-800 rounded text-sm hover:bg-yellow-200 transition-colors",children:[t.jsx(X,{className:"w-3 h-3"}),"Try ",r.recommendedOrientation," orientation"]}),r.recommendedPageSize&&t.jsxs("span",{className:"px-2 py-1 bg-yellow-100 text-yellow-800 rounded text-xs",children:["Consider ",r.recommendedPageSize," format"]})]})]})]})}),t.jsx("div",{className:"bg-gray-50 px-4 py-3 border-b border-gray-200",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(J,{className:"w-5 h-5 text-green-600"}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-medium text-gray-900",children:e}),t.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[t.jsx("span",{children:"Excel to PDF Preview"}),b&&b.length>1&&t.jsxs(t.Fragment,{children:[t.jsx("span",{children:"•"}),t.jsxs("span",{children:[b.length," files generated"]})]})]})]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[b&&b.length>1&&t.jsxs("div",{className:"flex items-center gap-1 bg-white border border-gray-300 rounded",children:[t.jsx("button",{onClick:()=>F(p-1),disabled:p===0,className:"p-1 hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",title:"Previous file",children:t.jsx("span",{className:"text-sm",children:"‹"})}),t.jsxs("span",{className:"px-2 text-sm font-mono",children:[p+1," / ",b.length]}),t.jsx("button",{onClick:()=>F(p+1),disabled:p===b.length-1,className:"p-1 hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",title:"Next file",children:t.jsx("span",{className:"text-sm",children:"›"})})]}),t.jsxs("div",{className:"flex items-center gap-1 bg-white border border-gray-300 rounded",children:[t.jsx("button",{onClick:k,disabled:g<=.5,className:"p-1 hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",title:"Zoom out",children:t.jsx(ee,{className:"w-4 h-4"})}),t.jsxs("span",{className:"px-2 text-sm font-mono",children:[Math.round(g*100),"%"]}),t.jsx("button",{onClick:D,disabled:g>=2,className:"p-1 hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",title:"Zoom in",children:t.jsx(te,{className:"w-4 h-4"})})]}),t.jsxs("div",{className:"flex gap-1",children:[b&&b.length>1&&s&&t.jsxs("button",{onClick:s,className:"flex items-center gap-2 px-3 py-1.5 bg-green-600 text-white rounded hover:bg-green-700 transition-colors",title:"Download all PDF files",children:[t.jsx(H,{className:"w-4 h-4"}),t.jsxs("span",{className:"text-sm font-medium",children:["All (",b.length,")"]})]}),t.jsxs("button",{onClick:a,className:"flex items-center gap-2 px-3 py-1.5 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors",title:b&&b.length>1?"Download current file":"Download PDF",children:[t.jsx(H,{className:"w-4 h-4"}),t.jsx("span",{className:"text-sm font-medium",children:b&&b.length>1?"Current":"Download"})]})]})]})]})}),t.jsx("div",{className:"p-4",children:i?t.jsx("div",{className:"flex items-center justify-center h-96",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-500 mx-auto mb-2"}),t.jsx("p",{className:"text-sm text-gray-600",children:"Loading preview..."})]})}):u?t.jsx("div",{className:"relative overflow-auto max-h-96",children:t.jsx("iframe",{src:`${u}#toolbar=0&navpanes=0&scrollbar=0`,className:"w-full border border-gray-300 rounded",style:{height:"400px",transform:`scale(${g})`,transformOrigin:"top left",width:`${100/g}%`},title:"Excel PDF Preview"})}):t.jsx("div",{className:"flex items-center justify-center h-96 text-gray-500",children:t.jsxs("div",{className:"text-center",children:[t.jsx(se,{className:"w-8 h-8 mx-auto mb-2"}),t.jsx("p",{children:"Preparing preview..."})]})})}),t.jsx("div",{className:"bg-gray-50 px-4 py-2 border-t border-gray-200",children:t.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-600",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("span",{children:"Preview may differ slightly from final PDF"}),w&&t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(ae,{className:"w-3 h-3"}),t.jsx("span",{children:w.sheetName||"Sheet"})]})]}),t.jsx("span",{children:w?`${Math.round(w.data.length/1024)} KB`:""})]})})]})},we={latin:[0,591],cyrillic:[1024,1279],arabic:[1536,1791],cjk:[19968,40959],devanagari:[2304,2431],thai:[3584,3711],hebrew:[1424,1535]},ve={latin:["en","fr","de","es","it","pt","nl","sv","no","da","fi"],cyrillic:["ru","uk","bg","sr","mk","be"],arabic:["ar","fa","ur"],cjk:["zh","ja","ko"],devanagari:["hi","ne","mr"],thai:["th"],hebrew:["he"]};async function ye(c){if(!c||c.trim().length===0)return{primaryLanguage:"en",confidence:.5,detectedLanguages:[{language:"en",confidence:.5,script:"latin"}],requiredFontSubsets:["latin"]};const e=c.trim().slice(0,1e3);try{const a=ue(e),s=je(e),l=[{language:a==="und"?"en":a,confidence:a==="und"?.5:.8,script:Pe(s)}];s.forEach(({script:d,percentage:r})=>{r>.1&&(ve[d]||[]).forEach(o=>{l.find(i=>i.language===o)||l.push({language:o,confidence:r,script:d})})});const n=Array.from(new Set(s.filter(d=>d.percentage>.05).map(d=>d.script)));return{primaryLanguage:l[0].language,confidence:l[0].confidence,detectedLanguages:l,requiredFontSubsets:n}}catch(a){return console.warn("Language detection failed:",a),{primaryLanguage:"en",confidence:.5,detectedLanguages:[{language:"en",confidence:.5,script:"latin"}],requiredFontSubsets:["latin"]}}}function je(c){const e={};let a=0;for(const s of c){const l=s.codePointAt(0);if(!l||l<32)continue;a++;const n=Fe(l);e[n]=(e[n]||0)+1}return Object.entries(e).map(([s,l])=>({script:s,percentage:l/a})).sort((s,l)=>l.percentage-s.percentage)}function Fe(c){for(const[e,[a,s]]of Object.entries(we))if(c>=a&&c<=s)return e;return"latin"}function Pe(c){return c.length>0?c[0].script:"latin"}class Ne{async parseExcelFile(e){try{const a=await e.arrayBuffer(),s=he(a,{cellStyles:!0,cellFormulas:!0,cellDates:!0,cellNF:!0,sheetStubs:!0}),l=[],n=new Set;for(const d of s.SheetNames){const r=s.Sheets[d],u=await this.parseWorksheet(r,d);l.push(u),u.metadata?.detectedLanguages.forEach(o=>n.add(o))}return{sheets:l,metadata:{fileName:e.name,fileSize:e.size,totalSheets:l.length,detectedLanguages:Array.from(n),requiresSpecialFont:this.requiresSpecialFont(Array.from(n)),estimatedPdfSize:this.estimatePdfSize(l)}}}catch(a){throw new Error(`Failed to parse Excel file: ${a instanceof Error?a.message:"Unknown error"}`)}}async parseWorksheet(e,a){const s=V.decode_range(e["!ref"]||"A1:A1"),l=[],n=[];for(let o=s.s.r;o<=s.e.r;o++){const i=[];for(let x=s.s.c;x<=s.e.c;x++){const m=V.encode_cell({c:x,r:o}),h=e[m],g=this.parseCell(h);i.push(g),g.value&&typeof g.value=="string"&&n.push(g.value)}l.push(i)}const d=await this.detectLanguages(n.join(" ")),r=this.extractColumnInfo(e),u=this.extractRowInfo(e);return{name:a,data:l,columns:r,rows:u,metadata:{totalColumns:s.e.c-s.s.c+1,totalRows:s.e.r-s.s.r+1,maxWidth:Math.max(...r.map(o=>o.width||100)),detectedLanguages:d.detectedLanguages.map(o=>o.language),hasWideTable:s.e.c-s.s.c+1>15}}}parseCell(e){if(!e)return{value:null,type:"string"};let a=null,s="string";e.v!==void 0&&(e.t==="n"?(a=e.v,s="number"):e.t==="d"?(a=new Date(e.v),s="date"):e.t==="b"?(a=e.v?"TRUE":"FALSE",s="boolean"):e.f?(a=e.w||String(e.v),s="formula"):(a=String(e.v),s="string"));const l=this.extractCellFormatting(e);return{value:a,type:s,formatting:l}}extractCellFormatting(e){if(!e.s)return;const a=e.s,s={};return a.font&&(a.font.name&&(s.fontFamily=a.font.name),a.font.sz&&(s.fontSize=a.font.sz),a.font.bold&&(s.bold=!0),a.font.italic&&(s.italic=!0),a.font.underline&&(s.underline=!0),a.font.color?.rgb&&(s.color=`#${a.font.color.rgb}`)),a.fill?.fgColor?.rgb&&(s.backgroundColor=`#${a.fill.fgColor.rgb}`),a.alignment&&(a.alignment.horizontal&&(s.alignment=a.alignment.horizontal),a.alignment.vertical&&(s.verticalAlignment=a.alignment.vertical)),a.border&&(s.border={top:!!a.border.top,right:!!a.border.right,bottom:!!a.border.bottom,left:!!a.border.left}),Object.keys(s).length>0?s:void 0}extractColumnInfo(e){return(e["!cols"]||[]).map(s=>({width:s.wch||s.wpx?s.wch||s.wpx/7:void 0,hidden:s.hidden||!1}))}extractRowInfo(e){return(e["!rows"]||[]).map(s=>({height:s.hpt||void 0,hidden:s.hidden||!1}))}async detectLanguages(e){try{return await ye(e)}catch{return{primaryLanguage:"en",confidence:.5,detectedLanguages:[{language:"en",confidence:.5,script:"latin"}],requiredFontSubsets:["latin"]}}}requiresSpecialFont(e){const a=["ru","ar","zh","ja","ko","hi","th"];return e.some(s=>a.includes(s))}estimatePdfSize(e){const a=e.reduce((s,l)=>s+(l.metadata?.totalColumns||0)*(l.metadata?.totalRows||0),0);return Math.max(5e5,a*100)}}const Se=new Ne;class Te{constructor(){L(this,"fontCache",new Map);L(this,"currentPdfDocId",null)}clearFontCacheIfNeeded(e){const a=e._id||`pdf_${Date.now()}_${Math.random()}`;this.currentPdfDocId!==a&&(console.log("🧹 Clearing font cache for new PDF document"),this.fontCache.clear(),this.currentPdfDocId=a,e._id=a)}async loadCyrillicFont(e,a){e.registerFontkit(de);const s=["https://cdn.jsdelivr.net/npm/dejavu-fonts-ttf@2.37.3/ttf/DejaVuSans.ttf","https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/webfonts/fa-solid-900.ttf","https://fonts.gstatic.com/s/notosans/v36/o-0IIpQlx3QUlC5A4PNr5TRASf6M7Q.woff2"];for(const l of s)try{console.log(`Trying to load font from: ${l}`);const n=await fetch(l,{mode:"cors",headers:{Accept:"application/font-woff2,application/font-woff,application/font-ttf,*/*"}});if(!n.ok){console.warn(`Font fetch failed: ${n.status} ${n.statusText}`);continue}const d=await n.arrayBuffer();if(d.byteLength<1e3){console.warn("Font data too small, probably not a valid font");continue}const r=await e.embedFont(d);return console.log(`✅ Successfully loaded font for ${a} from ${l}`),r}catch(n){console.warn(`Failed to load font from ${l}:`,n.message);continue}throw new Error("Unable to load any Cyrillic fonts from external sources")}async loadFont(e,a,s=!1){console.log(`🔤 Loading font for language: ${a}, isCyrillic: ${s}`),this.clearFontCacheIfNeeded(e);try{const n=`${e._id||this.currentPdfDocId}-${a}-${s}`;if(this.fontCache.has(n)){console.log(`💾 Using cached font for ${n}`);const i=this.fontCache.get(n);return{font:i.font,fontName:i.fontName,supportsCyrillic:i.supportsCyrillic,needsTransliteration:i.needsTransliteration}}let d,r=!1,u=s,o="Helvetica";if(s){console.log("🌍 Attempting to load Cyrillic font...");try{d=await this.loadCyrillicFont(e,a),r=!0,u=!1,o="DejaVu Sans",console.log("✅ Cyrillic font (DejaVu Sans) loaded successfully")}catch(i){console.warn(`⚠️ Failed to load Cyrillic font: ${i.message}`),console.log("🔄 Falling back to standard font with transliteration");try{d=await e.embedFont(E.TimesRoman),o="Times-Roman",console.log("✅ Times-Roman font loaded as fallback")}catch{console.warn("⚠️ Times-Roman also failed, using Helvetica"),d=await e.embedFont(E.Helvetica),o="Helvetica",console.log("✅ Helvetica font loaded as last resort")}r=!1,u=!0}}else console.log("📝 Loading standard Helvetica font for Latin text"),d=await e.embedFont(E.Helvetica),r=!1,u=!1,console.log("✅ Helvetica font loaded");return this.fontCache.set(n,{font:d,fontName:o,supportsCyrillic:r,needsTransliteration:u}),console.log(`💾 Font result cached: ${o} (key: ${n}, supportsCyrillic: ${r}, needsTransliteration: ${u})`),{font:d,fontName:o,supportsCyrillic:r,needsTransliteration:u}}catch(l){console.warn(`Failed to load font for ${a}, using final fallback:`,l);let n,d;try{n=await e.embedFont(E.TimesRoman),d="Times-Roman"}catch{n=await e.embedFont(E.Helvetica),d="Helvetica"}return{font:n,fontName:d,supportsCyrillic:!1,needsTransliteration:s}}}async generatePDF(e,a,s){try{const l=e.filter(n=>a.selectedSheets.includes(n.name));if(l.length===0)throw new Error("No sheets selected for conversion");return a.outputFormat==="separate-pdfs"?await this.generateSeparatePDFs(l,a,s):await this.generateSinglePDF(l,a,s)}catch(l){return{success:!1,error:l instanceof Error?l.message:"PDF generation failed"}}}async generateSinglePDF(e,a,s){const l=await _.create();l.setTitle("Excel to PDF Conversion"),l.setAuthor("LocalPDF"),l.setSubject("Excel Spreadsheet Conversion"),l.setKeywords(["excel","pdf","conversion","localpdf"]),l.setProducer("LocalPDF - Privacy-first PDF tools"),l.setCreator("LocalPDF"),l.setCreationDate(new Date),l.setModificationDate(new Date);const n=this.extractAllTextFromSheets(e),d=this.containsCyrillic(n);s?.(10,"Loading fonts...");const r=await this.loadFont(l,"ru",d);for(let o=0;o<e.length;o++){const i=e[o];s?.(20+o/e.length*70,`Processing ${i.name}...`),await this.addSheetToPDFDocument(l,i,a,r)}s?.(95,"Finalizing PDF...");const u=await l.save({useObjectStreams:!1,addDefaultPage:!1,objectsPerTick:50});return{success:!0,pdfFiles:[{name:"converted-excel.pdf",data:new Uint8Array(u)}],metadata:{totalPages:l.getPageCount(),fileSize:u.length,processingTime:Date.now()}}}async generateSeparatePDFs(e,a,s){const l=[],n=this.extractAllTextFromSheets(e),d=this.containsCyrillic(n);for(let u=0;u<e.length;u++){const o=e[u];s?.(u/e.length*90,`Generating ${o.name}.pdf...`);const i=await _.create();i.setTitle(`${o.name} - Excel to PDF`),i.setAuthor("LocalPDF"),i.setSubject(`Excel Sheet: ${o.name}`),i.setKeywords(["excel","pdf","conversion","localpdf",o.name]),i.setProducer("LocalPDF - Privacy-first PDF tools"),i.setCreator("LocalPDF"),i.setCreationDate(new Date),i.setModificationDate(new Date);const x=await this.loadFont(i,"ru",d);await this.addSheetToPDFDocument(i,o,a,x);const m=await i.save({useObjectStreams:!1,addDefaultPage:!1,objectsPerTick:50});l.push({name:`${this.sanitizeFileName(o.name)}.pdf`,data:new Uint8Array(m),sheetName:o.name})}const r=l.reduce((u,o)=>u+o.data.length,0);return{success:!0,pdfFiles:l,metadata:{totalPages:l.length,fileSize:r,processingTime:Date.now()}}}createPDFDocument(e){const a=e.pageSize.toLowerCase(),s=new jsPDF({orientation:e.orientation,unit:"mm",format:a});try{s.setFont("helvetica","normal"),s.setFontSize(e.fontSize)}catch{console.warn("Font setting failed, using default")}return s}addSheetTitle(e,a,s){const l=e.internal.pageSize.getWidth();e.setFontSize(16),e.setFont(s.fontFamily,"bold");const n=e.getTextWidth(a),d=(l-n)/2;e.text(a,d,s.margins.top+10)}async addSheetToPDF(e,a,s){if(!a.data||a.data.length===0)return;const{columns:l,tableData:n}=this.prepareTableData(a,s);if(l.length===0||n.length===0)return;const d=s.includeSheetNames?s.margins.top+20:s.margins.top;l.map(m=>m.header),n.map(m=>l.map(h=>m[h.dataKey]||"")),s.margins.top,s.margins.right,s.margins.bottom,s.margins.left,s.fontSize,s.fontFamily,s.handleWideTablesWith,this.getColumnStyles(a,s),s.handleWideTablesWith==="scale"&&a.metadata?.hasWideTable&&Math.max(6,s.fontSize-2);let r=d;const u=8,i=e.internal.pageSize.getWidth()-s.margins.left-s.margins.right,x=this.calculateColumnWidths(l,n,i);if(l.length>0){let m=s.margins.left;e.setFontSize(s.fontSize+1),e.setFont("helvetica","bold"),l.forEach((h,g)=>{const f=h.header.substring(0,8);e.text(f,m,r),m+=x[g]}),r+=u+2,e.line(s.margins.left,r-1,s.margins.left+i,r-1),r+=2}e.setFontSize(s.fontSize),e.setFont("helvetica","normal"),n.forEach(m=>{let h=s.margins.left;l.forEach((g,f)=>{const p=m[g.dataKey]||"",v=this.sanitizeTextForPDF(p.toString()),b=Math.floor(x[f]/3),w=v.substring(0,Math.max(b,8));e.text(w,h,r),h+=x[f]}),r+=u,r>e.internal.pageSize.getHeight()-s.margins.bottom-20&&(e.addPage(),r=s.margins.top)})}prepareTableData(e,a){console.log(`🔍 prepareTableData - Processing sheet: ${e.name}`),console.log(`📊 Raw data length: ${e.data?.length||0}`);const s=e.data,l=[],n=[];if(!s||s.length===0)return console.warn("⚠️ No data found in sheet"),{columns:l,tableData:n};console.log("📊 First row sample:",s[0]?.slice(0,3).map(i=>({value:i?.value,type:i?.type})));const d=Math.max(...s.map(i=>i?.length||0));console.log(`📏 Max columns in sheet: ${d}`);const r=[];for(let i=0;i<d;i++){let x=!1;for(let m=0;m<s.length;m++){const h=s[m]?.[i];if(h&&h.value!==null&&h.value!==void 0&&h.value!==""){x=!0;break}}x&&r.push(i)}console.log(`📋 Non-empty columns: [${r.join(", ")}] (${r.length} total)`),r.forEach((i,x)=>{const m=e.columns?.[i]?.width;let h="";const g=s[0]?.[i];g&&g.value!==null&&g.value!==void 0&&g.value!==""?h=String(g.value):h=`Column ${x+1}`,console.log(`📝 Column ${x}: "${h}" (original col ${i})`),l.push({header:h,dataKey:`col_${x}`,width:m?m*5:void 0})});const u=s.length>1?1:0;console.log(`📊 Processing data rows from ${u} to ${s.length-1}`);let o=0;for(let i=u;i<s.length;i++){if(e.rows?.[i]?.hidden){console.log(`⏭️ Skipping hidden row ${i}`);continue}const x={};r.forEach((m,h)=>{if(e.columns?.[m]?.hidden)return;const g=s[i]?.[m],f=this.formatCellValue(g);x[`col_${h}`]=f}),Object.values(x).some(m=>m&&m.trim()!=="")?(n.push(x),o++):console.log(`🚫 Skipping empty row ${i}`)}return console.log(`✅ Final result - Columns: ${l.length}, Data rows: ${n.length} (processed ${o})`),l.length>0&&console.log(`📋 Column headers: [${l.map(i=>`"${i.header}"`).join(", ")}]`),n.length>0&&console.log("📊 First data row sample:",Object.fromEntries(Object.entries(n[0]).slice(0,3))),{columns:l,tableData:n}}getColumnStyles(e,a){const s={};return e.columns&&e.columns.forEach((l,n)=>{l.width&&(s[`col_${n}`]={cellWidth:Math.max(10,l.width*3)})}),s}formatCellValue(e){return!e||e.value===null||e.value===void 0?"":e.type==="date"&&e.value instanceof Date?e.value.toLocaleDateString():e.type==="number"&&typeof e.value=="number"?e.value.toString():String(e.value)}numberToColumnLetter(e){let a="";for(;e>=0;)a=String.fromCharCode(e%26+65)+a,e=Math.floor(e/26)-1;return a}sanitizeTextForPDF(e){const a={а:"a",б:"b",в:"v",г:"g",д:"d",е:"e",ё:"yo",ж:"zh",з:"z",и:"i",й:"y",к:"k",л:"l",м:"m",н:"n",о:"o",п:"p",р:"r",с:"s",т:"t",у:"u",ф:"f",х:"kh",ц:"ts",ч:"ch",ш:"sh",щ:"sch",ъ:"",ы:"y",ь:"",э:"e",ю:"yu",я:"ya",А:"A",Б:"B",В:"V",Г:"G",Д:"D",Е:"E",Ё:"YO",Ж:"ZH",З:"Z",И:"I",Й:"Y",К:"K",Л:"L",М:"M",Н:"N",О:"O",П:"P",Р:"R",С:"S",Т:"T",У:"U",Ф:"F",Х:"KH",Ц:"TS",Ч:"CH",Ш:"SH",Щ:"SCH",Ъ:"",Ы:"Y",Ь:"",Э:"E",Ю:"YU",Я:"YA"};return e.split("").map(s=>a.hasOwnProperty(s)?a[s]:s).join("")}calculateColumnWidths(e,a,s){if(e.length===0)return[];const l=e.map((d,r)=>{const u=d.header.length,o=Math.max(...a.map(i=>(i[d.dataKey]||"").toString().length));return Math.max(u,o,8)}),n=l.reduce((d,r)=>d+r,0);return l.map(d=>{const r=d/n*s;return Math.max(r,25)})}sanitizeFileName(e){return e.replace(/[^a-zA-Z0-9_-]/g,"_")}analyzeTableLayout(e,a){const{columns:s}=this.prepareTableData(e,a),l=this.getPageDimensions(a.pageSize,a.orientation),[n]=l,d=50,r=10,u=n-d*2-r*Math.max(0,s.length-1),o=this.getOriginalColumnWidths(e,s,u),i=o.reduce((f,p)=>f+p,0),x=i>u?u/i:1,m=x<.8;let h,g;return m&&(a.orientation==="portrait"&&s.length>=5?h="landscape":a.orientation==="landscape"&&a.pageSize==="A4"&&s.length>=10&&(g="A3")),{isOverflowing:m,recommendedOrientation:h,recommendedPageSize:g,columnCount:s.length,scaleFactor:x<1?x:void 0,estimatedColumnWidths:o}}extractAllTextFromSheets(e){return e.map(a=>a.data.flat().map(s=>s.value?String(s.value):"").join(" ")).join(" ")}containsCyrillic(e){return/[\u0400-\u04FF]/.test(e)}getPageDimensions(e,a){const s={A4:{width:595,height:842},A3:{width:842,height:1191},Letter:{width:612,height:792},Legal:{width:612,height:1008}},l=s[e]||s.A4;return a==="landscape"?[l.height,l.width]:[l.width,l.height]}async addSheetToPDFDocument(e,a,s,l){console.log(`🔍 Processing sheet: ${a.name}`),console.log(`📄 Options - PageSize: ${s.pageSize}, Orientation: ${s.orientation}`);const n=this.getPageDimensions(s.pageSize,s.orientation);console.log(`📏 Page dimensions calculated: ${n[0]} x ${n[1]}`);const d=e.addPage([n[0],n[1]]),{width:r,height:u}=d.getSize();if(console.log(`✅ Page created with actual size: ${r} x ${u}`),(Math.abs(r-n[0])>1||Math.abs(u-n[1])>1)&&console.warn(`⚠️ Page size mismatch: expected ${n[0]}x${n[1]}, got ${r}x${u}`),s.includeSheetNames){const w=l.needsTransliteration?this.sanitizeTextForPDF(a.name):a.name;console.log(`📝 Adding sheet title: "${w}"`),d.drawText(w,{x:50,y:u-50,size:16,font:l.font,color:M(0,0,0)})}const{columns:o,tableData:i}=this.prepareTableData(a,s);if(console.log(`📊 Data prepared - Columns: ${o.length}, Rows: ${i.length}`),o.length===0&&console.warn("⚠️ No columns found - sheet will be empty"),i.length===0&&console.warn("⚠️ No table data found - sheet will be empty"),o.length===0||i.length===0){console.log("🚫 Exiting early - no data to display");return}const x=s.includeSheetNames?u-80:u-50,m=10,h=50,g=r-h*2-m*Math.max(0,o.length-1);console.log(`📐 Layout calculations:
      - Page width: ${r}
      - Page margins: ${h*2}
      - Column padding total: ${m*Math.max(0,o.length-1)}
      - Usable width: ${g}`);const f=this.getOriginalColumnWidths(a,o,g);console.log(`📏 Column widths: [${f.map(w=>Math.round(w)).join(", ")}]`);let p=x,v=d;const b=(w,N)=>{let P=h;o.forEach((D,k)=>{const F=l.needsTransliteration?this.sanitizeTextForPDF(D.header):D.header,y=f[k],$=(s.fontSize+1)*.6,S=Math.floor(y/$),z=F.length>S?F.substring(0,Math.max(1,S-3))+"...":F;console.log(`📝 Drawing header "${z}" at x=${P}, y=${N}`);try{w.drawText(z,{x:P,y:N,size:s.fontSize+1,font:l.font,color:M(0,0,0)})}catch(T){console.error(`Failed to draw header "${z}":`,T)}P+=f[k]+m})};console.log(`🎯 Drawing headers at y=${p}`),b(v,p),p-=25,i.forEach((w,N)=>{console.log(`📊 Processing row ${N+1}/${i.length}`);let P=1;const D=[];o.forEach((F,y)=>{let S=(w[F.dataKey]||"").toString();l.needsTransliteration&&(S=this.sanitizeTextForPDF(S));const z=s.fontSize*.6,T=f[y],A=Math.floor(T/z),W=this.wrapText(S,Math.max(1,A));D.push(W),P=Math.max(P,W.length)});for(let F=0;F<P;F++){let y=h;o.forEach(($,S)=>{const T=D[S][F]||"";if(T.trim()){const A=p-F*12;try{v.drawText(T,{x:y,y:A,size:s.fontSize,font:l.font,color:M(0,0,0)})}catch{console.warn(`Text rendering failed for "${T}", using fallback`);try{const I=this.sanitizeTextForPDF(T);v.drawText(I,{x:y,y:A,size:s.fontSize,font:l.font,color:M(0,0,0)})}catch(I){console.error("Even fallback text rendering failed:",I)}}}y+=f[S]+m})}const k=Math.max(18,P*12+6);if(p-=k,p<70){console.log(`📄 Creating new page (currentY=${p})`);const F=this.getPageDimensions(s.pageSize,s.orientation);v=e.addPage([F[0],F[1]]),p=v.getSize().height-50,b(v,p),p-=25}}),console.log(`✅ Sheet "${a.name}" processed successfully`)}wrapText(e,a){if(!e)return[""];if(a<1)return[""];if(a<3)return[e.substring(0,a)];if(e.length<=a)return[e];const s=e.split(" "),l=[];let n="";for(const d of s){if(d.length>a){n.trim()&&(l.push(n.trim()),n=""),a>3?l.push(d.substring(0,a-2)+".."):l.push(d.substring(0,a));continue}const r=n+d;r.length>a?(n.trim()&&l.push(n.trim()),n=d+" "):n=r+" "}return n.trim()&&l.push(n.trim()),l.length>0?l.slice(0,2):[""]}getOriginalColumnWidths(e,a,s){const n=[],d=Math.max(...e.data.map(o=>o.length)),r=[];for(let o=0;o<d;o++){let i=!1;for(let x=0;x<e.data.length;x++){const m=e.data[x]?.[o];if(m&&m.value!==null&&m.value!==void 0&&m.value!==""){i=!0;break}}i&&r.push(o)}a.forEach((o,i)=>{let x=o.header.length;const m=r[i];e.data.forEach((g,f)=>{if(f===0)return;const p=g[m];if(p&&p.value!==null&&p.value!==void 0){const v=String(p.value);x=Math.max(x,v.length)}});const h=Math.max(60,x*7);n.push(h)});const u=n.reduce((o,i)=>o+i,0);if(u>s){const o=s/u;return n.map(i=>Math.max(60,i*o))}if(u<s){const i=(s-u)/a.length;return n.map(x=>x+i)}return n}}const q=new Te,C=[{name:"DejaVu Sans",subset:"latin-cyrillic",languages:["en","ru","de","fr","es","no","sv","da"],size:18e4,loaded:!1},{name:"Noto Sans Latin",subset:"latin",languages:["en","fr","de","es","it","pt","nl","sv","no","da","fi"],size:12e4,loaded:!1},{name:"Noto Sans Cyrillic",subset:"cyrillic",languages:["ru","uk","bg","sr","mk","be"],size:14e4,loaded:!1},{name:"Noto Sans Arabic",subset:"arabic",languages:["ar","fa","ur"],size:16e4,loaded:!1},{name:"Noto Sans CJK",subset:"cjk",languages:["zh","ja","ko"],size:25e4,loaded:!1}];class Ce{constructor(){L(this,"loadedFonts",new Map);L(this,"loadingPromises",new Map)}async loadRequiredFonts(e,a){const s=C.filter(d=>e.some(r=>d.subset.includes(r)));if(s.length===0)return[C[0]];const l=s.map(async(d,r)=>(a?.(r,s.length,d.name),await this.loadFontSubset(d))),n=await Promise.all(l);return a?.(s.length,s.length,"Complete"),n.filter(d=>d.loaded)}async loadFontSubset(e){if(this.loadedFonts.has(e.name))return this.loadedFonts.get(e.name);if(this.loadingPromises.has(e.name))return await this.loadingPromises.get(e.name);const a=this.performFontLoad(e);this.loadingPromises.set(e.name,a);try{const s=await a;return this.loadedFonts.set(e.name,s),s}finally{this.loadingPromises.delete(e.name)}}async performFontLoad(e){try{const a=this.generateMockFontData(e),s={...e,loaded:!0};return await new Promise(l=>setTimeout(l,100)),s}catch(a){return console.warn(`Failed to load font ${e.name}:`,a),{...e,loaded:!1}}}generateMockFontData(e){return`mock-font-data-${e.name.toLowerCase().replace(/\s+/g,"-")}`}getBestFontForLanguages(e){for(const a of C)if(e.some(s=>a.languages.includes(s)))return a;return C[0]}getFontBySubset(e){return C.find(a=>a.subset===e)}getAvailableFonts(){return[...C]}isLanguageSupported(e){return C.some(a=>a.languages.includes(e))}getUnsupportedLanguages(e){return e.filter(a=>!this.isLanguageSupported(a))}estimateLoadSize(e){return C.filter(a=>e.some(s=>a.subset.includes(s))).reduce((a,s)=>a+s.size,0)}}const R=new Ce,De={selectedSheets:[],orientation:"portrait",pageSize:"A4",fontSize:10,fontFamily:"helvetica",includeSheetNames:!0,handleWideTablesWith:"scale",outputFormat:"single-pdf",margins:{top:20,right:20,bottom:20,left:20}};function ke(){const[c,e]=j.useState({workbook:null,isProcessing:!1,progress:null,error:null,result:null,availableFonts:R.getAvailableFonts(),showPreview:!1,tableAnalysis:null}),a=j.useRef(null),s=j.useCallback(m=>{e(h=>({...h,progress:m}))},[]),l=j.useCallback(m=>{e(h=>({...h,error:m,isProcessing:!1,progress:null}))},[]),n=j.useCallback(async m=>{if(!m){l("No file provided");return}if(!m.name.match(/\.(xlsx|xls)$/i)){l("Please select a valid Excel file (.xlsx or .xls)");return}if(m.size>100*1024*1024){l("File size must be less than 100MB");return}e(h=>({...h,isProcessing:!0,error:null,result:null,progress:{stage:"parsing",progress:0,message:"Parsing Excel file..."}}));try{a.current=new AbortController;const h=await Se.parseExcelFile(m);e(g=>({...g,workbook:h,isProcessing:!1,progress:{stage:"complete",progress:100,message:"File parsed successfully"}})),setTimeout(()=>{e(g=>({...g,progress:null}))},2e3)}catch(h){l(h instanceof Error?h.message:"Failed to parse Excel file")}},[l]),d=j.useCallback(async m=>{if(console.log("🚀 Starting convertToPDF with options:",m),!c.workbook){console.error("❌ No Excel file loaded"),l("No Excel file loaded");return}if(m.selectedSheets.length===0){console.error("❌ No sheets selected"),l("Please select at least one sheet to convert");return}console.log("✅ Validation passed, starting conversion..."),e(h=>({...h,isProcessing:!0,error:null,result:null}));try{a.current=new AbortController,s({stage:"analyzing",progress:10,message:"Analyzing content..."});const h=c.workbook.metadata.detectedLanguages.map(p=>R.getBestFontForLanguages([p]).subset).filter((p,v,b)=>b.indexOf(p)===v);h.length>0&&(s({stage:"loading-fonts",progress:30,message:"Loading fonts..."}),await R.loadRequiredFonts(h,(p,v,b)=>{const w=30+p/v*20;s({stage:"loading-fonts",progress:w,message:`Loading ${b}...`})})),s({stage:"generating",progress:50,message:"Generating PDF..."});const g=c.workbook.sheets.filter(p=>m.selectedSheets.includes(p.name));console.log("📊 Converting sheets:",g.map(p=>p.name));const f=await q.generatePDF(g,m,(p,v)=>{const b=50+p/100*45;s({stage:"generating",progress:b,message:v})});console.log("🎉 Conversion result:",{success:f.success,hasFiles:!!f.pdfFiles,filesCount:f.pdfFiles?.length,error:f.error,firstFileName:f.pdfFiles?.[0]?.name,firstFileSize:f.pdfFiles?.[0]?.data?.length}),f.success?(console.log("✅ Setting state with result and showPreview=true"),e(p=>({...p,result:f,isProcessing:!1,showPreview:!0,progress:{stage:"complete",progress:100,message:"Conversion completed successfully!"}})),console.log("🔄 State should now have showPreview=true and result with files"),setTimeout(()=>{e(p=>({...p,progress:null}))},2e3)):(console.error("❌ Conversion failed:",f.error),l(f.error||"Conversion failed"))}catch(h){console.error("❌ Conversion error:",h),l(h instanceof Error?h.message:"Conversion failed")}},[c.workbook,l,s]),r=j.useCallback(m=>{try{const h=new Blob([m.data],{type:"application/pdf"}),g=URL.createObjectURL(h),f=document.createElement("a");f.href=g,f.download=m.name,document.body.appendChild(f),f.click(),document.body.removeChild(f),URL.revokeObjectURL(g)}catch{l("Failed to download PDF")}},[l]),u=j.useCallback(()=>{if(!c.result?.pdfFiles){l("No PDF files to download");return}c.result.pdfFiles.forEach(m=>{r(m)})},[c.result?.pdfFiles,r,l]),o=j.useCallback(()=>{a.current&&a.current.abort(),e({workbook:null,isProcessing:!1,progress:null,error:null,result:null,availableFonts:R.getAvailableFonts(),showPreview:!1,tableAnalysis:null})},[]),i=j.useCallback(()=>{e(m=>({...m,showPreview:!m.showPreview}))},[]),x=j.useCallback(m=>{if(!c.workbook||m.selectedSheets.length===0){e(h=>({...h,tableAnalysis:null}));return}try{const h=c.workbook.sheets.find(f=>m.selectedSheets.includes(f.name));if(!h){e(f=>({...f,tableAnalysis:null}));return}const g=q.analyzeTableLayout(h,m);e(f=>({...f,tableAnalysis:{isOverflowing:g.isOverflowing,recommendedOrientation:g.recommendedOrientation,recommendedPageSize:g.recommendedPageSize,columnCount:g.columnCount,scaleFactor:g.scaleFactor}}))}catch(h){console.warn("Table analysis failed:",h),e(g=>({...g,tableAnalysis:null}))}},[c.workbook]);return{...c,parseFile:n,convertToPDF:d,downloadPDF:r,downloadAllPDFs:u,reset:o,togglePreview:i,analyzeTable:x}}const ze=({workbook:c,options:e,onOptionsChange:a,onConvert:s,isProcessing:l})=>{const{t:n}=B(),d=o=>{const i=e.selectedSheets.includes(o)?e.selectedSheets.filter(x=>x!==o):[...e.selectedSheets,o];a({...e,selectedSheets:i})},r=()=>{const o=c.sheets.map(i=>i.name);a({...e,selectedSheets:o})},u=()=>{a({...e,selectedSheets:[]})};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-semibold mb-4",children:n("tools.excelToPdf.selectSheets")}),t.jsxs("div",{className:"flex gap-2 mb-4",children:[t.jsx(O,{onClick:r,variant:"secondary",size:"sm",children:n("tools.excelToPdf.selectAll")}),t.jsx(O,{onClick:u,variant:"secondary",size:"sm",children:n("tools.excelToPdf.deselectAll")})]}),t.jsx("div",{className:"grid gap-2 max-h-40 overflow-y-auto",children:c.sheets.map(o=>t.jsxs("label",{className:"flex items-center space-x-3 p-3 border rounded-lg hover:bg-gray-50 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:e.selectedSheets.includes(o.name),onChange:()=>d(o.name),className:"w-4 h-4 text-blue-600 rounded"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("div",{className:"font-medium",children:o.name}),t.jsx("div",{className:"text-sm text-gray-500",children:n("tools.excelToPdf.rowsColumns",{rows:o.metadata?.totalRows||0,columns:o.metadata?.totalColumns||0})})]})]},o.name))})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-2",children:n("tools.excelToPdf.pageOrientation")}),t.jsxs("select",{value:e.orientation,onChange:o=>a({...e,orientation:o.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"portrait",children:n("tools.excelToPdf.portrait")}),t.jsx("option",{value:"landscape",children:n("tools.excelToPdf.landscape")})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-2",children:n("tools.excelToPdf.pageSize")}),t.jsxs("select",{value:e.pageSize,onChange:o=>a({...e,pageSize:o.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"A4",children:"A4"}),t.jsx("option",{value:"A3",children:"A3"}),t.jsx("option",{value:"Letter",children:"Letter"}),t.jsx("option",{value:"Legal",children:"Legal"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-2",children:n("tools.excelToPdf.fontSize")}),t.jsx("input",{type:"number",min:"6",max:"20",value:e.fontSize,onChange:o=>a({...e,fontSize:parseInt(o.target.value)}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-2",children:n("tools.excelToPdf.outputFormat")}),t.jsxs("select",{value:e.outputFormat,onChange:o=>a({...e,outputFormat:o.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"single-pdf",children:n("tools.excelToPdf.singlePdf")}),t.jsx("option",{value:"separate-pdfs",children:n("tools.excelToPdf.separatePdfs")})]})]})]}),t.jsx("div",{children:t.jsxs("label",{className:"flex items-center space-x-2",children:[t.jsx("input",{type:"checkbox",checked:e.includeSheetNames,onChange:o=>a({...e,includeSheetNames:o.target.checked}),className:"w-4 h-4 text-blue-600 rounded"}),t.jsx("span",{className:"text-sm font-medium",children:n("tools.excelToPdf.includeSheetNames")})]})}),t.jsx(O,{onClick:s,disabled:l||e.selectedSheets.length===0,className:"w-full",children:n(l?"tools.excelToPdf.converting":"tools.excelToPdf.convertToPdf")})]})},$e=()=>{const{t:c}=B(),{workbook:e,isProcessing:a,progress:s,error:l,result:n,showPreview:d,tableAnalysis:r,parseFile:u,convertToPDF:o,downloadPDF:i,downloadAllPDFs:x,reset:m,togglePreview:h,analyzeTable:g}=ke(),[f,p]=U.useState({...De,selectedSheets:[]});U.useEffect(()=>{e&&p(N=>({...N,selectedSheets:e.sheets.map(P=>P.name)}))},[e]),U.useEffect(()=>{e&&f.selectedSheets.length>0&&g(f)},[e,f,g]);const v=async N=>{N.length>0&&await u(N[0])},b=async()=>{console.log("🔥 handleConvert called with options:",f),console.log("📋 Current state:",{hasWorkbook:!!e,selectedSheets:f.selectedSheets,isProcessing:a}),await o(f)},w=()=>{const N=f.orientation==="portrait"?"landscape":"portrait";p(P=>({...P,orientation:N}))};return l?t.jsx("div",{className:"max-w-4xl mx-auto p-6",children:t.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:[t.jsx("div",{className:"flex",children:t.jsxs("div",{className:"text-red-800",children:[t.jsx("strong",{children:"Error:"})," ",l]})}),t.jsx(O,{onClick:m,className:"mt-4",variant:"secondary",children:"Try Again"})]})}):t.jsx("div",{className:"max-w-7xl mx-auto p-6",children:e?t.jsxs("div",{className:"space-y-6",children:[n?.success&&t.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:"text-green-600 mr-2",children:"✅"}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-green-800 font-medium",children:c("tools.excelToPdf.conversionCompleted")}),t.jsx("p",{className:"text-green-700 text-sm",children:n.pdfFiles?.length===1?c("tools.excelToPdf.pdfReady"):c("tools.excelToPdf.multipleFiles",{count:n.pdfFiles?.length})})]})]})}),s&&t.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[t.jsxs("div",{className:"mb-2 flex justify-between",children:[t.jsx("span",{className:"text-sm font-medium text-gray-700",children:s.message}),t.jsxs("span",{className:"text-sm text-gray-500",children:[Math.round(s.progress),"%"]})]}),t.jsx(oe,{progress:s.progress,className:"h-2 bg-gray-200 rounded-full"})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsx("div",{className:"space-y-6",children:t.jsxs("div",{className:"bg-white rounded-lg shadow-lg overflow-hidden h-[600px]",children:[" ",(()=>(console.log("🔍 ExcelToPDFTool Preview Data:",{result:n?{success:n.success,hasFiles:!!n.pdfFiles,filesCount:n.pdfFiles?.length}:null,showPreview:d,isProcessing:a,workbook:!!e,tableAnalysis:r}),t.jsx(be,{result:n,fileName:e?.metadata.fileName||"excel-document.pdf",onDownload:()=>n?.pdfFiles?.[0]&&i(n.pdfFiles[0]),onDownloadAll:n?.pdfFiles&&n.pdfFiles.length>1?x:void 0,isGenerating:a,onRegenerate:e?b:void 0,onOrientationToggle:w,tableOverflowWarning:r?{isOverflowing:r.isOverflowing,recommendedOrientation:r.recommendedOrientation,recommendedPageSize:r.recommendedPageSize,columnCount:r.columnCount,scaleFactor:r.scaleFactor}:void 0})))()]})}),t.jsx("div",{className:"space-y-6",children:t.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 h-[600px] flex flex-col",children:[" ",t.jsx("h2",{className:"text-xl font-semibold mb-4",children:c("tools.excelToPdf.conversionSettings")}),t.jsxs("div",{className:"flex-1 overflow-y-auto",children:[" ",t.jsx(ze,{workbook:e,options:f,onOptionsChange:p,onConvert:b,isProcessing:a})]})]})})]}),t.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[t.jsx("h2",{className:"text-xl font-semibold mb-4",children:c("tools.excelToPdf.fileInformation")}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 text-sm",children:[t.jsxs("div",{children:[t.jsxs("strong",{children:[c("tools.excelToPdf.file"),":"]})," ",e.metadata.fileName]}),t.jsxs("div",{children:[t.jsxs("strong",{children:[c("tools.excelToPdf.size"),":"]})," ",Math.round(e.metadata.fileSize/1024)," KB"]}),t.jsxs("div",{children:[t.jsxs("strong",{children:[c("tools.excelToPdf.sheets"),":"]})," ",e.metadata.totalSheets]}),t.jsxs("div",{children:[t.jsxs("strong",{children:[c("tools.excelToPdf.languages"),":"]})," ",e.metadata.detectedLanguages.join(", ")||"English"]})]}),e.metadata.detectedLanguages.length>1&&t.jsx("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:t.jsx("div",{className:"text-sm text-blue-800",children:c("tools.excelToPdf.multiLanguageNote")})}),t.jsx("button",{onClick:m,className:"mt-4 text-sm text-red-600 hover:text-red-800 underline",children:c("tools.excelToPdf.chooseDifferentFile")})]})]}):t.jsx("div",{className:"max-w-2xl mx-auto",children:t.jsx("div",{className:"bg-white rounded-lg shadow-lg p-8 mb-6",children:t.jsx(me,{onFilesSelected:v,accept:".xlsx,.xls",acceptedTypes:["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel"],maxSize:100*1024*1024,multiple:!1,children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-6xl mb-4",children:"📊"}),t.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-2",children:c("tools.excelToPdf.chooseExcelFile")}),t.jsx("p",{className:"text-gray-500 mb-6",children:c("tools.excelToPdf.dragDropSubtitle")}),t.jsx("div",{className:"mt-6 text-sm text-gray-400",children:t.jsx("p",{children:c("tools.excelToPdf.supportedFormats")})}),t.jsxs("div",{className:"mt-4 text-xs text-gray-400 space-y-1",children:[t.jsxs("p",{children:["✓ ",c("tools.excelToPdf.multipleSheets")]}),t.jsxs("p",{children:["✓ ",c("tools.excelToPdf.complexFormulas")]}),t.jsxs("p",{children:["✓ ",c("tools.excelToPdf.internationalText")]}),t.jsxs("p",{children:["✓ ",c("tools.excelToPdf.localProcessing")]})]})]})})})})})},Ye=()=>{const{t:c}=re(),{currentLanguage:e}=B(),a=ne.excelToPdf,s=pe("excel-to-pdf",e);j.useEffect(()=>{window.scrollTo(0,0)},[]);const l=[{label:c("common.home"),href:"/"},{label:c("tools.excelToPdf.title"),href:"/excel-to-pdf"}];return t.jsxs(t.Fragment,{children:[t.jsx(le,{title:a.title,description:a.description,keywords:a.keywords,canonical:a.canonical,structuredData:a.structuredData,faqSchema:s.map(n=>({question:n.question,answer:n.answer}))}),t.jsxs("div",{className:"min-h-screen bg-gradient-mesh flex flex-col",children:[t.jsx(ie,{}),t.jsxs("main",{className:"flex-grow container mx-auto px-4 pt-20 pb-8",children:[t.jsx(ge,{items:l}),t.jsxs("div",{className:"text-center mb-8",children:[t.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-secondary-900 mb-4",children:t.jsx("span",{className:"text-gradient-blue",children:c("tools.excelToPdf.title")})}),t.jsx("p",{className:"text-lg text-secondary-600 max-w-3xl mx-auto",children:c("tools.excelToPdf.pageDescription")})]}),t.jsx($e,{}),t.jsx("div",{className:"mt-12 max-w-4xl mx-auto",children:t.jsxs("div",{className:"bg-white rounded-lg shadow-md p-8 mb-8",children:[t.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-6",children:c("tools.excelToPdf.howToTitle")}),t.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"w-16 h-16 bg-primary-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:t.jsx("span",{className:"text-3xl",children:"📊"})}),t.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:c("tools.excelToPdf.uploadTitle")}),t.jsx("p",{className:"text-gray-600 text-sm",children:c("tools.excelToPdf.uploadDescription")})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"w-16 h-16 bg-success-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:t.jsx("span",{className:"text-3xl",children:"⚙️"})}),t.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:c("tools.excelToPdf.configureTitle")}),t.jsx("p",{className:"text-gray-600 text-sm",children:c("tools.excelToPdf.configureDescription")})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"w-16 h-16 bg-purple-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:t.jsx("span",{className:"text-3xl",children:"📥"})}),t.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:c("tools.excelToPdf.downloadTitle")}),t.jsx("p",{className:"text-gray-600 text-sm",children:c("tools.excelToPdf.downloadDescription")})]})]})]})}),t.jsx(xe,{title:c("tools.excelToPdf.faqTitle"),faqs:s,className:"mb-8",defaultOpen:!1}),t.jsx(fe,{currentTool:"excel-to-pdf"})]}),t.jsx(ce,{})]})]})};export{Ye as default};
